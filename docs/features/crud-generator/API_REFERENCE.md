# ðŸ“š CRUD Generator API Reference

> **Complete API documentation for generated backend and frontend modules**

This document provides comprehensive API documentation for modules generated by the CRUD Generator system.

## ðŸŽ¯ Generated Backend API

### Standard CRUD Endpoints

All generated modules include these core endpoints:

#### Create Resource

```http
POST /api/{resource}
Content-Type: application/json
Authorization: Bearer {token}

{
  "title": "Example Book",
  "author_id": "123e4567-e89b-12d3-a456-426614174000",
  "isbn": "9781234567890",
  "status": "available"
}
```

**Response:**

```json
{
  "success": true,
  "data": {
    "id": "123e4567-e89b-12d3-a456-426614174001",
    "title": "Example Book",
    "author_id": "123e4567-e89b-12d3-a456-426614174000",
    "isbn": "9781234567890",
    "status": "available",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  },
  "message": "Resource created successfully"
}
```

#### Get Single Resource

```http
GET /api/{resource}/{id}
Authorization: Bearer {token}
```

**Response:**

```json
{
  "success": true,
  "data": {
    "id": "123e4567-e89b-12d3-a456-426614174001",
    "title": "Example Book",
    "author_id": "123e4567-e89b-12d3-a456-426614174000",
    "isbn": "9781234567890",
    "status": "available",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  }
}
```

#### List Resources

```http
GET /api/{resource}?page=1&limit=20&sort=title:asc&status=available
Authorization: Bearer {token}
```

**Query Parameters:**

- `page` (number): Page number (default: 1)
- `limit` (number): Items per page (default: 20, max: 100)
- `sort` (string): Sort field and direction (e.g., `title:asc`, `created_at:desc`)
- `search` (string): Search across searchable fields
- `fields` (string): Comma-separated list of fields to return
- `{field_name}` (various): Filter by any field value
- `{field_name}_min` (number/date): Minimum value filter
- `{field_name}_max` (number/date): Maximum value filter
- `{field_name}_in` (string): Comma-separated list of values
- `{field_name}_not_in` (string): Comma-separated exclusion list

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174001",
      "title": "Example Book",
      "status": "available",
      "created_at": "2024-01-15T10:30:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 150,
    "pages": 8,
    "hasNext": true,
    "hasPrev": false
  },
  "meta": {
    "searchTerm": "example",
    "filters": {
      "status": "available"
    },
    "sort": "title:asc"
  }
}
```

#### Update Resource

```http
PUT /api/{resource}/{id}
Content-Type: application/json
Authorization: Bearer {token}

{
  "title": "Updated Book Title",
  "status": "checked_out"
}
```

**Response:**

```json
{
  "success": true,
  "data": {
    "id": "123e4567-e89b-12d3-a456-426614174001",
    "title": "Updated Book Title",
    "author_id": "123e4567-e89b-12d3-a456-426614174000",
    "isbn": "9781234567890",
    "status": "checked_out",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T12:45:00Z"
  },
  "message": "Resource updated successfully"
}
```

#### Delete Resource

```http
DELETE /api/{resource}/{id}
Authorization: Bearer {token}
```

**Response:**

```json
{
  "success": true,
  "message": "Resource deleted successfully"
}
```

### Enhanced Package Endpoints

When using the enhanced package, additional endpoints are generated:

#### Dropdown Options

```http
GET /api/{resource}/dropdown
Authorization: Bearer {token}
```

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "value": "123e4567-e89b-12d3-a456-426614174001",
      "label": "Example Book"
    },
    {
      "value": "123e4567-e89b-12d3-a456-426614174002",
      "label": "Another Book"
    }
  ]
}
```

#### Bulk Create

```http
POST /api/{resource}/bulk
Content-Type: application/json
Authorization: Bearer {token}

{
  "items": [
    {
      "title": "Book 1",
      "author_id": "123e4567-e89b-12d3-a456-426614174000",
      "status": "available"
    },
    {
      "title": "Book 2",
      "author_id": "123e4567-e89b-12d3-a456-426614174000",
      "status": "available"
    }
  ]
}
```

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174003",
      "title": "Book 1",
      "status": "available",
      "created_at": "2024-01-15T10:30:00Z"
    },
    {
      "id": "123e4567-e89b-12d3-a456-426614174004",
      "title": "Book 2",
      "status": "available",
      "created_at": "2024-01-15T10:30:00Z"
    }
  ],
  "message": "2 resources created successfully"
}
```

#### Bulk Update

```http
PUT /api/{resource}/bulk
Content-Type: application/json
Authorization: Bearer {token}

{
  "updates": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174001",
      "data": { "status": "checked_out" }
    },
    {
      "id": "123e4567-e89b-12d3-a456-426614174002",
      "data": { "status": "reserved" }
    }
  ]
}
```

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174001",
      "status": "checked_out",
      "updated_at": "2024-01-15T12:45:00Z"
    },
    {
      "id": "123e4567-e89b-12d3-a456-426614174002",
      "status": "reserved",
      "updated_at": "2024-01-15T12:45:00Z"
    }
  ],
  "message": "2 resources updated successfully"
}
```

#### Bulk Delete

```http
DELETE /api/{resource}/bulk
Content-Type: application/json
Authorization: Bearer {token}

{
  "ids": [
    "123e4567-e89b-12d3-a456-426614174001",
    "123e4567-e89b-12d3-a456-426614174002"
  ]
}
```

**Response:**

```json
{
  "success": true,
  "message": "2 resources deleted successfully"
}
```

#### Data Validation

```http
POST /api/{resource}/validate
Content-Type: application/json
Authorization: Bearer {token}

{
  "title": "Test Book",
  "isbn": "invalid-isbn",
  "status": "invalid-status"
}
```

**Response:**

```json
{
  "success": false,
  "errors": [
    {
      "field": "isbn",
      "message": "Invalid ISBN format",
      "value": "invalid-isbn"
    },
    {
      "field": "status",
      "message": "Status must be one of: available, checked_out, reserved",
      "value": "invalid-status"
    }
  ]
}
```

#### Field Uniqueness Check

```http
GET /api/{resource}/check/isbn?value=9781234567890&exclude=123e4567-e89b-12d3-a456-426614174001
Authorization: Bearer {token}
```

**Response:**

```json
{
  "success": true,
  "available": false,
  "message": "ISBN already exists"
}
```

#### Statistics

```http
GET /api/{resource}/stats
Authorization: Bearer {token}
```

**Response:**

```json
{
  "success": true,
  "data": {
    "total": 1250,
    "statusCounts": {
      "available": 850,
      "checked_out": 300,
      "reserved": 100
    },
    "recentCount": 45,
    "trends": {
      "created_this_week": 12,
      "created_last_week": 8,
      "growth_rate": 0.5
    },
    "averages": {
      "page_count": 245.5,
      "price": 24.99
    }
  }
}
```

### Full Package Endpoints

The full package includes additional advanced endpoints:

#### Advanced Search

```http
POST /api/{resource}/search
Content-Type: application/json
Authorization: Bearer {token}

{
  "query": "fiction adventure",
  "filters": {
    "status": ["available", "reserved"],
    "price_range": [10, 50],
    "publication_date": {
      "from": "2020-01-01",
      "to": "2024-12-31"
    }
  },
  "facets": ["genre", "author"],
  "highlight": true,
  "page": 1,
  "limit": 20
}
```

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174001",
      "title": "Adventure <mark>Fiction</mark>",
      "genre": "fiction",
      "status": "available",
      "score": 0.95
    }
  ],
  "facets": {
    "genre": {
      "fiction": 45,
      "adventure": 23,
      "mystery": 12
    },
    "author": {
      "John Doe": 15,
      "Jane Smith": 8
    }
  },
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 68,
    "pages": 4
  }
}
```

#### Export Data

```http
POST /api/{resource}/export
Content-Type: application/json
Authorization: Bearer {token}

{
  "format": "csv",
  "fields": ["title", "author", "status", "created_at"],
  "filters": {
    "status": "available"
  },
  "options": {
    "include_headers": true,
    "date_format": "YYYY-MM-DD"
  }
}
```

**Response:**

- Content-Type: application/octet-stream
- Content-Disposition: attachment; filename="books-export-2024-01-15.csv"
- Binary data with exported content

## ðŸŽ¨ Generated Frontend API

### Service Methods

Generated Angular services provide these methods:

#### Core CRUD Methods

```typescript
class BookService {
  // Create new resource
  async create(data: CreateBook): Promise<Book> {
    const response = await this.http.post<ApiResponse<Book>>(`${this.baseUrl}`, data).toPromise();
    return response.data;
  }

  // Get single resource
  async getById(id: string): Promise<Book> {
    const response = await this.http.get<ApiResponse<Book>>(`${this.baseUrl}/${id}`).toPromise();
    return response.data;
  }

  // List resources with filtering
  async list(query: ListBookQuery = {}): Promise<PaginatedResponse<Book>> {
    const params = new HttpParams({ fromObject: query as any });
    const response = await this.http.get<ApiResponse<Book[]>>(this.baseUrl, { params }).toPromise();
    return response;
  }

  // Update resource
  async update(id: string, data: UpdateBook): Promise<Book> {
    const response = await this.http.put<ApiResponse<Book>>(`${this.baseUrl}/${id}`, data).toPromise();
    return response.data;
  }

  // Delete resource
  async delete(id: string): Promise<void> {
    await this.http.delete(`${this.baseUrl}/${id}`).toPromise();
  }
}
```

#### Enhanced Methods (Enhanced Package)

```typescript
class BookService {
  // Get dropdown options
  async getDropdownOptions(): Promise<DropdownOption[]> {
    const response = await this.http.get<ApiResponse<DropdownOption[]>>(`${this.baseUrl}/dropdown`).toPromise();
    return response.data;
  }

  // Bulk operations
  async bulkCreate(items: CreateBook[]): Promise<Book[]> {
    const response = await this.http.post<ApiResponse<Book[]>>(`${this.baseUrl}/bulk`, { items }).toPromise();
    return response.data;
  }

  async bulkUpdate(updates: BulkUpdate<Book>[]): Promise<Book[]> {
    const response = await this.http.put<ApiResponse<Book[]>>(`${this.baseUrl}/bulk`, { updates }).toPromise();
    return response.data;
  }

  async bulkDelete(ids: string[]): Promise<void> {
    await this.http
      .delete(`${this.baseUrl}/bulk`, {
        body: { ids },
      })
      .toPromise();
  }

  // Validation
  async validate(data: Partial<Book>): Promise<ValidationResult> {
    const response = await this.http.post<ValidationResult>(`${this.baseUrl}/validate`, data).toPromise();
    return response;
  }

  // Uniqueness check
  async checkUnique(field: string, value: string, excludeId?: string): Promise<boolean> {
    const params = new HttpParams().set('value', value).set('exclude', excludeId || '');

    const response = await this.http.get<{ available: boolean }>(`${this.baseUrl}/check/${field}`, { params }).toPromise();
    return response.available;
  }

  // Statistics
  async getStats(): Promise<ResourceStats> {
    const response = await this.http.get<ApiResponse<ResourceStats>>(`${this.baseUrl}/stats`).toPromise();
    return response.data;
  }

  // Export
  async exportData(data: Book[], format: ExportFormat): Promise<Blob> {
    return this.http.post(`${this.baseUrl}/export`, { data, format }, { responseType: 'blob' }).toPromise();
  }
}
```

### Component APIs

#### List Component

```typescript
class BookListComponent {
  // Signals for reactive state
  data = signal<Book[]>([]);
  loading = signal<boolean>(false);
  filters = signal<ListBookQuery>({});
  selectedItems = signal<string[]>([]);
  stats = signal<ResourceStats | null>(null);

  // Filter methods
  applyFilters(): void;
  clearFilters(): void;
  applyQuickFilter(field: string, value: string): void;

  // Selection methods
  toggleSelection(id: string): void;
  toggleSelectAll(): void;
  clearSelection(): void;

  // CRUD operations
  openCreateDialog(): void;
  openEditDialog(item: Book): void;
  openViewDialog(item: Book): void;
  confirmDelete(id: string): Promise<void>;

  // Bulk operations
  bulkDelete(): Promise<void>;
  bulkUpdate(data: Partial<Book>): Promise<void>;
  bulkExport(format: ExportFormat): Promise<void>;

  // Utility methods
  loadData(): Promise<void>;
  refreshStats(): Promise<void>;
  handleSort(column: string): void;
  handlePageChange(page: number): void;
}
```

#### Dialog Components

```typescript
// Create Dialog
class BookCreateDialogComponent {
  form: FormGroup;
  isSubmitting = signal<boolean>(false);

  async onSubmit(): Promise<void>;
  onCancel(): void;
}

// Edit Dialog
class BookEditDialogComponent {
  form: FormGroup;
  originalData: Book;
  isSubmitting = signal<boolean>(false);

  async onSubmit(): Promise<void>;
  onCancel(): void;
  hasChanges(): boolean;
}

// View Dialog
class BookViewDialogComponent {
  data: Book;

  onEdit(): void;
  onDelete(): Promise<void>;
  onClose(): void;
}
```

## ðŸ“‹ Type Definitions

### Backend Types

```typescript
// Generated TypeScript interfaces
export interface Book {
  id: string;
  title: string;
  author_id: string;
  isbn?: string;
  publication_date?: Date;
  status: BookStatus;
  genre?: string;
  page_count?: number;
  price?: number;
  created_at: Date;
  updated_at: Date;
}

export interface CreateBook {
  title: string;
  author_id: string;
  isbn?: string;
  publication_date?: Date;
  status: BookStatus;
  genre?: string;
  page_count?: number;
  price?: number;
}

export interface UpdateBook {
  title?: string;
  author_id?: string;
  isbn?: string;
  publication_date?: Date;
  status?: BookStatus;
  genre?: string;
  page_count?: number;
  price?: number;
}

export type BookStatus = 'available' | 'checked_out' | 'reserved';

export interface ListBookQuery {
  page?: number;
  limit?: number;
  sort?: string;
  search?: string;
  fields?: string;
  title?: string;
  status?: BookStatus;
  author_id?: string;
  genre?: string;
  price_min?: number;
  price_max?: number;
  publication_date_min?: string;
  publication_date_max?: string;
  created_at_min?: string;
  created_at_max?: string;
}

export interface BulkUpdate<T> {
  id: string;
  data: Partial<T>;
}

export interface DropdownOption {
  value: string;
  label: string;
}

export interface ValidationResult {
  success: boolean;
  errors?: ValidationError[];
}

export interface ValidationError {
  field: string;
  message: string;
  value: any;
}

export interface ResourceStats {
  total: number;
  statusCounts: Record<string, number>;
  recentCount: number;
  trends: {
    created_this_week: number;
    created_last_week: number;
    growth_rate: number;
  };
  averages: Record<string, number>;
}
```

### Frontend Types

```typescript
// Additional frontend-specific types
export type ExportFormat = 'csv' | 'excel' | 'json' | 'pdf';

export interface QuickFilter {
  field: string;
  value: string;
  label: string;
  count: number;
  icon?: string;
}

export interface FilterConfig {
  field: string;
  type: 'text' | 'select' | 'date' | 'number' | 'boolean';
  label: string;
  options?: DropdownOption[];
  placeholder?: string;
}

export interface TableColumn {
  field: string;
  label: string;
  sortable: boolean;
  type: 'text' | 'date' | 'number' | 'boolean' | 'enum';
  format?: string;
  width?: string;
}

export interface BulkAction {
  id: string;
  label: string;
  icon: string;
  action: (selectedIds: string[]) => Promise<void>;
  requiresConfirmation?: boolean;
  dangerAction?: boolean;
}
```

## ðŸ”§ Configuration Options

### API Response Configuration

```typescript
// Standard API response wrapper
export interface ApiResponse<T> {
  success: boolean;
  data: T;
  message?: string;
  errors?: ValidationError[];
}

export interface PaginatedResponse<T> extends ApiResponse<T[]> {
  pagination: {
    page: number;
    limit: number;
    total: number;
    pages: number;
    hasNext: boolean;
    hasPrev: boolean;
  };
  meta?: {
    searchTerm?: string;
    filters?: Record<string, any>;
    sort?: string;
  };
}
```

### Error Responses

```typescript
// Standard error response format
export interface ErrorResponse {
  success: false;
  error: {
    code: string;
    message: string;
    details?: any;
    timestamp: string;
    path: string;
  };
}

// Common error codes
export enum ErrorCodes {
  VALIDATION_ERROR = 'VALIDATION_ERROR',
  NOT_FOUND = 'NOT_FOUND',
  UNAUTHORIZED = 'UNAUTHORIZED',
  FORBIDDEN = 'FORBIDDEN',
  DUPLICATE_ENTRY = 'DUPLICATE_ENTRY',
  INTERNAL_ERROR = 'INTERNAL_ERROR',
}
```

## ðŸ§ª Testing APIs

### Generated Test Utilities

```typescript
// Backend test utilities
export class BookTestFactory {
  static createValidBook(overrides?: Partial<CreateBook>): CreateBook {
    return {
      title: 'Test Book',
      author_id: 'test-author-id',
      status: 'available',
      isbn: '9781234567890',
      ...overrides,
    };
  }

  static createValidBooks(count: number): CreateBook[] {
    return Array.from({ length: count }, (_, i) => this.createValidBook({ title: `Test Book ${i + 1}` }));
  }
}

// Frontend test utilities
export class BookTestHelpers {
  static mockBookService(): jasmine.SpyObj<BookService> {
    return jasmine.createSpyObj('BookService', ['create', 'getById', 'list', 'update', 'delete', 'bulkCreate', 'bulkUpdate', 'bulkDelete', 'validate', 'checkUnique', 'getStats', 'exportData']);
  }

  static createMockBook(overrides?: Partial<Book>): Book {
    return {
      id: 'test-id',
      title: 'Test Book',
      author_id: 'test-author-id',
      status: 'available',
      created_at: new Date(),
      updated_at: new Date(),
      ...overrides,
    };
  }
}
```

## ðŸ“š Integration Examples

### Frontend Service Integration

```typescript
// Example component using generated service
@Component({...})
export class BookManagementComponent implements OnInit {
  private bookService = inject(BookService);

  books = signal<Book[]>([]);
  loading = signal<boolean>(false);

  async ngOnInit() {
    await this.loadBooks();
  }

  async loadBooks() {
    this.loading.set(true);
    try {
      const response = await this.bookService.list({
        page: 1,
        limit: 20,
        sort: 'title:asc'
      });
      this.books.set(response.data);
    } catch (error) {
      console.error('Failed to load books:', error);
    } finally {
      this.loading.set(false);
    }
  }

  async createBook(bookData: CreateBook) {
    try {
      const newBook = await this.bookService.create(bookData);
      this.books.update(books => [...books, newBook]);
    } catch (error) {
      console.error('Failed to create book:', error);
    }
  }
}
```

### Backend API Integration

```typescript
// Example external API client
class BookApiClient {
  constructor(
    private baseUrl: string,
    private token: string,
  ) {}

  async createBook(book: CreateBook): Promise<Book> {
    const response = await fetch(`${this.baseUrl}/api/books`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${this.token}`,
      },
      body: JSON.stringify(book),
    });

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }

    const result = await response.json();
    return result.data;
  }

  async searchBooks(query: string, filters: any = {}): Promise<Book[]> {
    const params = new URLSearchParams({
      search: query,
      ...filters,
    });

    const response = await fetch(`${this.baseUrl}/api/books?${params}`, {
      headers: {
        Authorization: `Bearer ${this.token}`,
      },
    });

    const result = await response.json();
    return result.data;
  }
}
```

---

**This API reference provides complete documentation for all generated endpoints and methods, enabling seamless integration and development.** ðŸ“š

_The generated APIs follow RESTful conventions and include comprehensive error handling, validation, and type safety throughout the stack._
