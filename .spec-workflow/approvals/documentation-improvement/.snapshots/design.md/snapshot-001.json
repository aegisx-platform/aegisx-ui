{
  "id": "snapshot_1765928601963_qbfk9b8do",
  "approvalId": "approval_1765928601946_ptkesex24",
  "approvalTitle": "Design - Documentation Improvement",
  "version": 1,
  "timestamp": "2025-12-16T23:43:21.963Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Design Document\n\n## Overview\n\nThis design addresses documentation gaps across three critical areas:\n1. **Feature Development Standard** - Complete workflow guide (from 30% to 100%)\n2. **aegisx-ui Component Library** - Comprehensive component reference (23+ components)\n3. **Backend Architecture** - Advanced repository features documentation\n\nThe implementation will ensure aegisx-ui docs live in the library directory (`libs/aegisx-ui/docs/`) for standalone usage while maintaining clear cross-references from monorepo docs.\n\n## Steering Document Alignment\n\n### Technical Standards (tech.md)\n\n**Documentation Standards:**\n- Follow Diátaxis framework (Tutorials, How-To Guides, Reference, Explanation)\n- Use markdown with consistent formatting\n- Include code examples tested against actual implementation\n- Version documentation with codebase changes\n\n**Library Architecture:**\n- aegisx-ui docs SHALL be self-contained for standalone library usage\n- Monorepo docs SHALL link to library docs (not duplicate)\n- Follow git subtree sync patterns for library documentation\n\n### Project Structure (structure.md)\n\n**Follows established patterns:**\n```\ndocs/                           # Monorepo documentation\n├── guides/development/\n│   └── feature-development-standard.md  # Enhanced\n├── architecture/\n│   └── backend-architecture.md          # Enhanced with UUID, field selection\n└── reference/ui/\n    └── aegisx-ui-overview.md            # NEW: Links to library docs\n\nlibs/aegisx-ui/                 # Library with standalone docs\n├── docs/                       # Self-contained documentation\n│   ├── README.md\n│   ├── THEMING_GUIDE.md        # Existing\n│   ├── TOKEN_REFERENCE.md      # Existing\n│   ├── COMPONENT_OVERVIEW.md   # NEW\n│   └── components/             # NEW: Per-component docs\n└── src/lib/components/         # Implementation\n```\n\n## Code Reuse Analysis\n\n### Existing Components to Leverage\n\n**Documentation Infrastructure:**\n- **VitePress setup** (`docs/.vitepress/config.ts`): Leverage for navigation structure\n- **Existing doc patterns**: Reuse formatting from `docs/guides/` for consistency\n- **Component source code**: Extract TypeScript interfaces for API documentation\n\n**Theming Documentation:**\n- **THEMING_GUIDE.md** (594 lines): Already comprehensive, keep as-is\n- **TOKEN_REFERENCE.md**: Complete token documentation, no changes needed\n\n### Integration Points\n\n**Git Subtree Sync:**\n- `libs/aegisx-ui/` syncs to GitHub: `aegisx-platform/aegisx-ui`\n- Use `sync-to-repo.sh` script after documentation updates\n- Ensure documentation is part of library package\n\n**Cross-References:**\n- Monorepo docs SHALL use relative links: `../../libs/aegisx-ui/docs/components/...`\n- Library docs SHALL NOT link to monorepo (must be standalone)\n\n## Architecture\n\n### Modular Design Principles\n\n**Single File Responsibility:**\n- Each component doc covers ONE component only\n- Feature Development Standard organized by phase (5 separate sections)\n- Backend Architecture sections clearly separated by topic\n\n**Component Isolation:**\n- Component docs independent (can read calendar.md without reading card.md)\n- Cross-references only for related components\n\n**Documentation as Code:**\n- Docs live close to implementation (`libs/aegisx-ui/docs/` with `libs/aegisx-ui/src/`)\n- Enables documentation updates during code changes\n- Git subtree ensures library docs sync to standalone repository\n\n```mermaid\ngraph TD\n    A[Monorepo docs/] -->|Links to| B[libs/aegisx-ui/docs/]\n    B -->|Git Subtree| C[GitHub: aegisx-ui]\n    B -->|Lives with| D[libs/aegisx-ui/src/]\n\n    E[Developer] -->|Reads overview| A\n    E -->|Reads API details| B\n    F[Library User] -->|Reads| C\n\n    style A fill:#e3f2fd\n    style B fill:#c8e6c9\n    style C fill:#fff9c4\n    style D fill:#ffccbc\n```\n\n## Components and Interfaces\n\n### Component 1: Feature Development Standard Enhancement\n\n**Purpose:** Transform 66-line outline into comprehensive 500+ line guide with 5 detailed phases\n\n**Structure:**\n```markdown\n# Feature Development Standard\n\n## Phase 1: Planning & Documentation\n### Step 1.1: Create Feature Specification\n- [ ] Checklist item with example\n- [ ] Tool/command reference\n### Step 1.2: Define Requirements\n...\n\n## Phase 2: Backend Implementation\n### Step 2.1: API Design (API-First)\n...\n\n## Phase 3: Frontend Implementation\n...\n\n## Phase 4: Integration & Testing\n...\n\n## Phase 5: Documentation & Deployment\n...\n\n## Appendix\n- Templates\n- Examples\n- Common Pitfalls\n```\n\n**Interfaces:**\n- Input: Current incomplete standard (66 lines)\n- Output: Complete guide with 5 phases, checklists, examples\n- Links to: QA Checklist, API-First Standard, Domain Architecture\n\n**Dependencies:**\n- Existing QA checklist (`docs/guides/development/qa-checklist.md`)\n- API calling standard (`docs/guides/development/api-calling-standard.md`)\n- Universal full-stack standard\n\n**Reuses:**\n- Domain architecture guide examples\n- CRUD generator workflow patterns\n- Existing checklist items from QA guide\n\n### Component 2: aegisx-ui Component Reference System\n\n**Purpose:** Create comprehensive documentation for 23+ components with consistent API reference format\n\n**Component Doc Template:**\n```markdown\n# {Component Name}\n\n## Overview\nBrief description and use cases\n\n## Installation & Import\n```typescript\nimport { AxCalendarComponent } from '@aegisx/ui';\n```\n\n## Basic Usage\n```typescript\n// Simple example\n```\n\n## API Reference\n\n### Inputs\n| Name | Type | Default | Description |\n|------|------|---------|-------------|\n\n### Outputs\n| Name | Type | Description |\n|------|------|-------------|\n\n### Methods\n| Name | Signature | Description |\n|------|-----------|-------------|\n\n## Advanced Usage\n### Scenario 1\n### Scenario 2\n\n## Styling & Theming\n- Material tokens\n- Custom CSS variables\n\n## Accessibility\n- ARIA attributes\n- Keyboard navigation\n\n## Related Components\n```\n\n**Interfaces:**\n- Input: Component TypeScript source code\n- Output: Markdown documentation with complete API reference\n- Automated: Extract interfaces from TypeScript decorators (@Input, @Output)\n\n**Dependencies:**\n- Component source files in `libs/aegisx-ui/src/lib/components/`\n- TypeScript interfaces for type information\n- Theming guide for styling references\n\n**Reuses:**\n- Existing component implementations as single source of truth\n- THEMING_GUIDE.md for styling patterns\n- Material Design documentation patterns\n\n### Component 3: Backend Architecture Enhancements\n\n**Purpose:** Document advanced BaseRepository features (UUID validation, field selection, multi-sort, audit fields)\n\n**Sections to Add:**\n\n**3.1 UUID Validation Section**\n```markdown\n## UUID Validation System\n\n### Overview\nBaseRepository includes automatic UUID validation...\n\n### Configuration\n```typescript\nrepository.setUUIDValidationConfig({\n  strategy: UUIDValidationStrategy.STRICT\n});\n```\n\n### Strategies\n1. STRICT: Throw errors\n2. GRACEFUL: Filter invalid UUIDs\n3. WARN: Log warnings only\n\n### Common Errors\n...\n```\n\n**3.2 Field Selection Section**\n```markdown\n## Field Selection\n\n### Query Parameter\nGET /api/users?fields=id,name,email\n\n### Security Considerations\n- Only select necessary fields\n- Validate field names\n- Performance optimization\n\n### Examples\n...\n```\n\n**Interfaces:**\n- Input: Existing backend-architecture.md (2620 lines)\n- Output: Same file with 4 new sections (add ~400 lines)\n- Position: After \"Base Repository Pattern\" section\n\n**Dependencies:**\n- `apps/api/src/shared/repositories/base.repository.ts` (source of truth)\n- `apps/api/src/shared/utils/uuid.utils.ts` (UUID validation implementation)\n\n**Reuses:**\n- Existing backend architecture structure\n- Code examples from actual repository implementation\n\n### Component 4: Documentation Cross-Reference System\n\n**Purpose:** Link monorepo docs to library docs without duplication\n\n**File: `docs/reference/ui/aegisx-ui-overview.md` (NEW)**\n```markdown\n# AegisX UI Component Library\n\n## Overview\nAegisX UI is a comprehensive Angular component library...\n\n## Quick Start\n[Basic example]\n\n## Component Categories\n- Data Display: [link to libs/aegisx-ui/docs/components/data-display/]\n- Forms: [link to libs/aegisx-ui/docs/components/forms/]\n...\n\n## Detailed Documentation\nFor complete API reference, see:\n- [Component Documentation](../../libs/aegisx-ui/docs/components/)\n- [Theming Guide](../../libs/aegisx-ui/docs/THEMING_GUIDE.md)\n- [Token Reference](../../libs/aegisx-ui/docs/TOKEN_REFERENCE.md)\n```\n\n**Interfaces:**\n- Input: None (new file)\n- Output: Navigation hub to library docs\n- Links: Relative paths to `libs/aegisx-ui/docs/`\n\n**Dependencies:**\n- aegisx-ui component docs (must exist first)\n\n## Data Models\n\n### Documentation Metadata Model\n\n```typescript\ninterface ComponentDoc {\n  name: string;              // Component name (e.g., \"Calendar\")\n  selector: string;          // HTML selector (e.g., \"ax-calendar\")\n  category: DocCategory;     // Category for organization\n  inputs: InputDoc[];        // Component inputs\n  outputs: OutputDoc[];      // Component outputs\n  methods: MethodDoc[];      // Public methods\n  examples: CodeExample[];   // Usage examples\n  relatedComponents: string[]; // Related component names\n}\n\ninterface InputDoc {\n  name: string;\n  type: string;\n  defaultValue?: string;\n  description: string;\n  required: boolean;\n}\n\ninterface OutputDoc {\n  name: string;\n  type: string;\n  description: string;\n}\n\ninterface MethodDoc {\n  name: string;\n  signature: string;\n  description: string;\n  returnType: string;\n}\n\ntype DocCategory =\n  | 'data-display'\n  | 'forms'\n  | 'feedback'\n  | 'navigation'\n  | 'layout'\n  | 'theme'\n  | 'auth'\n  | 'integrations';\n```\n\n### Component Inventory\n\n```yaml\nComponents (23+):\n  data-display:\n    - calendar\n    - card\n    - code-tabs\n    - data-display (group)\n  forms:\n    - input-otp\n    - scheduler\n    - date-picker\n    - popup-edit\n    - knob\n    - time-slots\n  feedback:\n    - loading-button\n    - skeleton\n    - error-state\n    - empty-state\n  navigation:\n    - navigation\n    - drawer\n    - launcher\n  layout:\n    - layout\n    - gridster\n  theme:\n    - theme-builder\n    - theme-switcher\n  auth:\n    - auth (group)\n  integrations:\n    - integrations (group)\n```\n\n## Error Handling\n\n### Error Scenarios\n\n**1. Broken Internal Links**\n- **Scenario:** Documentation links to non-existent files\n- **Handling:** Validate all links during documentation build\n- **Prevention:** Use relative paths, verify before commit\n\n**2. Outdated Code Examples**\n- **Scenario:** Code examples don't match current API\n- **Handling:** Extract examples from actual working code or tests\n- **Prevention:** Test examples against current codebase before publishing\n\n**3. Missing Component Documentation**\n- **Scenario:** Component exists but no documentation file\n- **Handling:** Create component doc using template\n- **Prevention:** Checklist in component creation workflow\n\n**4. Git Subtree Sync Failure**\n- **Scenario:** aegisx-ui docs don't sync to GitHub\n- **Handling:** Manual sync using `sync-to-repo.sh`\n- **Prevention:** Verify sync in CI/CD pipeline\n\n**5. Documentation Drift**\n- **Scenario:** Docs and code become out of sync over time\n- **Handling:** Periodic alignment checks (like this spec)\n- **Prevention:** Update docs during code changes, CI validation\n\n## Testing Strategy\n\n### Documentation Validation Testing\n\n**Automated Checks:**\n```bash\n# Link validation\nfind docs -name \"*.md\" -exec markdown-link-check {} \\;\n\n# Code example extraction test\n# Extract all ```typescript blocks and verify syntax\ngrep -r \"```typescript\" docs/ | # extract examples\n\n# Cross-reference validation\n# Ensure all component docs exist\n```\n\n**Manual Review Checklist:**\n- [ ] All code examples copy-paste ready\n- [ ] All API references match TypeScript interfaces\n- [ ] All links resolve (no 404s)\n- [ ] Screenshots/diagrams up to date\n- [ ] Consistent formatting across all docs\n\n### Alignment Verification Testing\n\n**Before Documentation:**\n- Document current state (already done: 85.8% alignment)\n\n**After Documentation:**\n- Re-run alignment check\n- Target: 98%+ alignment\n- Verify each requirement:\n  - Feature Development Standard: Complete 5 phases ✓\n  - Component docs: 23+ files exist ✓\n  - Backend Architecture: UUID, field selection, multi-sort, audit sections ✓\n  - aegisx-ui docs: In libs/aegisx-ui/docs/ ✓\n  - Cross-references: Links working ✓\n\n### Integration Testing\n\n**Git Subtree Sync Test:**\n```bash\n# After completing aegisx-ui docs\ncd libs/aegisx-ui\nbash sync-to-repo.sh\n\n# Verify on GitHub\n# Check: https://github.com/aegisx-platform/aegisx-ui/tree/main/docs\n```\n\n**Navigation Test:**\n```bash\n# Start from monorepo root\ncd docs/reference/ui/\n# Follow link to aegisx-ui-overview.md\n# Follow link to libs/aegisx-ui/docs/components/calendar.md\n# Verify: No broken links in chain\n```\n\n### User Acceptance Testing\n\n**Developer Experience Test:**\n1. New developer onboarding scenario:\n   - Start with Feature Development Standard\n   - Follow Phase 1 workflow\n   - Verify: Can complete Phase 1 without asking questions\n2. Component usage scenario:\n   - Developer needs to use ax-calendar\n   - Reads COMPONENT_OVERVIEW.md → components/data-display/calendar.md\n   - Verify: Can implement calendar without reading source code\n3. Repository feature scenario:\n   - Developer needs UUID validation\n   - Reads Backend Architecture → UUID Validation section\n   - Verify: Can configure UUID validation without trial-and-error\n\n## Implementation Priority\n\n### Phase 1: Foundation (High Priority)\n1. Create aegisx-ui documentation structure\n2. Complete Feature Development Standard\n\n### Phase 2: Component Docs (Medium Priority)\n3. Generate component reference docs (23+ files)\n4. Create COMPONENT_OVERVIEW.md\n\n### Phase 3: Enhancements (Low Priority)\n5. Update Backend Architecture\n6. Create cross-reference system\n\n### Phase 4: Validation (Critical)\n7. Link validation\n8. Alignment verification\n9. Git subtree sync test\n\n## File Modifications Summary\n\n**New Files (30+):**\n- `libs/aegisx-ui/docs/COMPONENT_OVERVIEW.md`\n- `libs/aegisx-ui/docs/components/{category}/{component}.md` (23+ files)\n- `docs/reference/ui/aegisx-ui-overview.md`\n\n**Modified Files (2):**\n- `docs/guides/development/feature-development-standard.md` (66 → 500+ lines)\n- `docs/architecture/backend-architecture.md` (+400 lines for 4 sections)\n\n**Moved Files (0):**\n- All existing aegisx-ui docs already in correct location\n\n**Total Documentation Size:**\n- Current: ~4,500 lines\n- After: ~12,000+ lines (167% increase)\n- Alignment: 85.8% → 98%+\n",
  "fileStats": {
    "size": 14577,
    "lines": 542,
    "lastModified": "2025-12-16T23:43:14.790Z"
  },
  "comments": []
}
