import { Component, inject } from '@angular/core';
import { CommonModule } from '@angular/common';
import { Router } from '@angular/router';
import {
  AxLauncherComponent,
  LauncherApp,
  LauncherAppClickEvent,
} from '@aegisx/ui';
import { MASTER_DATA_ITEMS } from './master-data.config';

/**
 * Master Data Component
 *
 * Displays a launcher grid for all master data CRUD modules.
 * Uses ax-launcher component for card-based navigation.
 *
 * Modules are configured in master-data.config.ts and can be
 * auto-registered by CRUD generator when using --shell option.
 */
@Component({
  selector: 'app-master-data',
  standalone: true,
  imports: [CommonModule, AxLauncherComponent],
  template: `
    <div class="master-data-container">
      <!-- Header -->
      <div class="master-data-header">
        <h1>Master Data</h1>
        <p class="subtitle">Manage your {{title}} master data modules</p>
      </div>

      <!-- Launcher Grid -->
      <ax-launcher
        [apps]="masterDataItems"
        title="Master Data Modules"
        subtitle="Select a module to manage"
        (appClick)="onModuleSelect($event)"
      />
    </div>
  `,
  styles: [
    `
      .master-data-container {
        padding: var(--ax-spacing-lg, 24px);
        max-width: 1400px;
        margin: 0 auto;
      }

      .master-data-header {
        margin-bottom: var(--ax-spacing-xl, 32px);
      }

      .master-data-header h1 {
        font-size: var(--ax-text-2xl, 1.5rem);
        font-weight: var(--ax-font-semibold, 600);
        color: var(--ax-text-default);
        margin: 0 0 var(--ax-spacing-xs, 4px) 0;
      }

      .master-data-header .subtitle {
        font-size: var(--ax-text-sm, 0.875rem);
        color: var(--ax-text-subtle);
        margin: 0;
      }
    `,
  ],
})
export class MasterDataComponent {
  private readonly router = inject(Router);

  readonly masterDataItems: LauncherApp[] = MASTER_DATA_ITEMS;

  /**
   * Handle module selection from launcher
   */
  onModuleSelect(event: LauncherAppClickEvent): void {
    const app = event.app;
    if (app.route) {
      if (event.newTab) {
        window.open(app.route, '_blank');
      } else {
        this.router.navigate([app.route]);
      }
    } else if (app.externalUrl) {
      window.open(app.externalUrl, '_blank');
    }
  }
}
