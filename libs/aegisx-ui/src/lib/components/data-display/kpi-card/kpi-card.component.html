<div [class]="cardClasses">
  <!-- Color Accent Bar -->
  @if (accentColor) {
    <div [class]="accentClasses"></div>
  }

  <div class="ax-kpi-card__content">
    <!-- Simple Variant: Label + Value + Change -->
    @if (variant === 'simple') {
      <div class="ax-kpi-card__header">
        <div class="ax-kpi-card__label">{{ label }}</div>
      </div>
      <div class="ax-kpi-card__body">
        <div class="ax-kpi-card__value-row">
          <div class="ax-kpi-card__value">{{ value }}</div>
          @if (change !== undefined && change !== null) {
            <div [class]="changeClasses">{{ formattedChange }}</div>
          }
        </div>
      </div>
    }

    <!-- Badge Variant: Label with Badge + Value -->
    @if (variant === 'badge') {
      <div class="ax-kpi-card__header ax-kpi-card__header--with-badge">
        <div class="ax-kpi-card__label">{{ label }}</div>
        @if (badge) {
          <div [class]="badgeClasses">{{ badge }}</div>
        }
      </div>
      <div class="ax-kpi-card__body">
        <div class="ax-kpi-card__value">{{ value }}</div>
      </div>
    }

    <!-- Compact Variant: Minimal spacing -->
    @if (variant === 'compact') {
      <div class="ax-kpi-card__header ax-kpi-card__header--compact">
        <span class="ax-kpi-card__label ax-kpi-card__label--compact">{{
          label
        }}</span>
        @if (change !== undefined && change !== null) {
          <span [class]="changeClasses">{{ formattedChange }}</span>
        }
      </div>
      <div class="ax-kpi-card__body ax-kpi-card__body--compact">
        <div class="ax-kpi-card__value">{{ value }}</div>
      </div>
    }

    <!-- Accent Variant: With color accent bar -->
    @if (variant === 'accent') {
      <div class="ax-kpi-card__header ax-kpi-card__header--with-badge">
        <span class="ax-kpi-card__label">{{ label }}</span>
        @if (change !== undefined && change !== null) {
          <span [class]="changeClasses">{{ formattedChange }}</span>
        }
      </div>
      <div class="ax-kpi-card__body">
        <div class="ax-kpi-card__value">{{ value }}</div>
      </div>
    }

    <!-- Visual Indicator Variant: Bars + Value + Supplementary -->
    @if (variant === 'visual-indicator') {
      <div class="ax-kpi-card__header">
        <div class="ax-kpi-card__label">{{ label }}</div>
      </div>
      <div class="ax-kpi-card__body ax-kpi-card__body--visual-indicator">
        <div class="ax-kpi-card__bars">
          @for (filled of barsArray; track $index) {
            <div
              class="ax-kpi-card__bar"
              [class.ax-kpi-card__bar--filled]="filled"
              [class.ax-kpi-card__bar--empty]="!filled"
              [style.background-color]="
                filled
                  ? 'var(--ax-' + barColor + '-default)'
                  : 'var(--ax-border-default)'
              "
            ></div>
          }
        </div>
        <div class="ax-kpi-card__value-group">
          <div class="ax-kpi-card__value">{{ value }}</div>
          @if (supplementary) {
            <div class="ax-kpi-card__supplementary">{{ supplementary }}</div>
          }
        </div>
      </div>
    }

    <!-- Progress Variant: Value + Progress Bar + Label -->
    @if (variant === 'progress') {
      <div class="ax-kpi-card__header">
        <div class="ax-kpi-card__label">{{ label }}</div>
      </div>
      <div class="ax-kpi-card__body">
        <div class="ax-kpi-card__value">{{ value }}</div>
      </div>
      <div class="ax-kpi-card__progress-container">
        <div class="ax-kpi-card__progress-bar">
          <div
            class="ax-kpi-card__progress-fill"
            [style.width.%]="progress"
            [style.background-color]="'var(--ax-' + progressColor + '-default)'"
          ></div>
        </div>
        @if (progressLabel || progress !== undefined) {
          <div class="ax-kpi-card__progress-info">
            <span
              class="ax-kpi-card__progress-percent"
              [style.color]="'var(--ax-' + progressColor + '-default)'"
            >
              {{ progress }}%
            </span>
            @if (progressLabel) {
              <span class="ax-kpi-card__progress-label">{{
                progressLabel
              }}</span>
            }
          </div>
        }
      </div>
    }

    <!-- Segmented Variant: Value + Segmented Progress + Legend -->
    @if (variant === 'segmented') {
      <div class="ax-kpi-card__header">
        <div class="ax-kpi-card__label">{{ label }}</div>
      </div>
      <div class="ax-kpi-card__body">
        <div class="ax-kpi-card__value">{{ value }}</div>
      </div>
      <div class="ax-kpi-card__segmented-container">
        <div class="ax-kpi-card__segmented-bar">
          @for (segment of segments; track $index) {
            <div
              class="ax-kpi-card__segment"
              [style.width.%]="segment.value"
              [style.background-color]="segment.color"
            ></div>
          }
        </div>
        @if (segments.length > 0) {
          <div class="ax-kpi-card__segmented-legend">
            @for (segment of segments; track $index) {
              <div class="ax-kpi-card__legend-item">
                <span class="ax-kpi-card__legend-value"
                  >{{ segment.value }}%</span
                >
                <div class="ax-kpi-card__legend-color-label">
                  <span
                    class="ax-kpi-card__legend-dot"
                    [style.background-color]="segment.color"
                  ></span>
                  @if (segment.label) {
                    <span class="ax-kpi-card__legend-label">{{
                      segment.label
                    }}</span>
                  }
                </div>
              </div>
            }
          </div>
        }
      </div>
    }

    <!-- Optional subtitle -->
    @if (subtitle) {
      <div class="ax-kpi-card__subtitle">{{ subtitle }}</div>
    }

    <!-- Content projection for custom content (progress bars, charts, etc.) -->
    <div class="ax-kpi-card__custom">
      <ng-content></ng-content>
    </div>
  </div>

  <!-- Footer content projection -->
  <div class="ax-kpi-card__footer">
    <ng-content select="[footer]"></ng-content>
  </div>
</div>
