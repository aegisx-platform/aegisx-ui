@use '@angular/material' as mat;

/* ============================================
   Material Component Overrides
   Customize Material components to match AegisX's minimal aesthetic
   Uses both Material Design 3 tokens and AegisX custom tokens
   ============================================ */

// ===== Cards - Tremor Style (minimal elevation, subtle borders) =====
@include mat.card-overrides(
  (
    // Elevated/Raised card (default) - Has shadow, no border
    elevated-container-color: var(--ax-background-default),
    elevated-container-shape: var(--ax-radius-md),
    elevated-container-elevation: var(--ax-shadow-md),
    // มี shadow
    // Outlined card - Has border, NO shadow
    outlined-container-color: var(--ax-background-default),
    outlined-container-shape: var(--ax-radius-md),
    outlined-outline-color: var(--ax-border-default),
    outlined-outline-width: 1px,
    outlined-container-elevation: none,

    // ไม่มี shadow!
    // Filled card - Has background fill, subtle shadow
    filled-container-color: var(--ax-background-subtle),
    // สีแตกต่าง
    filled-container-shape: var(--ax-radius-md),
    filled-container-elevation: var(--ax-shadow-sm)
  )
);

// Card header border and content padding (using AegisX spacing tokens)
.mat-mdc-card {
  .mat-mdc-card-header {
    border-bottom: 1px solid var(--ax-border-default);
    padding-bottom: var(--ax-spacing-md) !important; // 16px
  }

  .mat-mdc-card-content {
    padding-top: var(--ax-spacing-md) !important; // 16px
  }
}

// EXPLICIT filled card background override (testing)
.mat-mdc-card[appearance='filled'] {
  background-color: var(--ax-background-subtle) !important;
  // Also try the MDC variant
  .mdc-card__content {
    background-color: var(--ax-background-subtle) !important;
  }
}

// ===== Buttons - Tremor Style (flatter, cleaner) =====
// Regular buttons (filled, outlined, text, tonal, protected)
@include mat.button-overrides(
  (
    // Shape - Apply consistent border radius for all button types (subtle rounding)
    filled-container-shape: var(--ax-radius-sm),
    outlined-container-shape: var(--ax-radius-sm),
    text-container-shape: var(--ax-radius-sm),
    tonal-container-shape: var(--ax-radius-sm),
    protected-container-shape: var(--ax-radius-sm)
  )
);

// FAB buttons
@include mat.fab-overrides(
  (
    // Shape
    container-shape: var(--ax-radius-sm),
    small-container-shape: var(--ax-radius-sm),
    extended-container-shape: var(--ax-radius-sm),
    // Shadows
    container-elevation-shadow: var(--ax-shadow-md),
    hover-container-elevation-shadow: var(--ax-shadow-lg),
    small-container-elevation-shadow: var(--ax-shadow-md),
    small-hover-container-elevation-shadow: var(--ax-shadow-lg)
  )
);

// Icon buttons
@include mat.icon-button-overrides(
  (
    // Shape
    container-shape: var(--ax-radius-sm)
  )
);

// Icons
@include mat.icon-overrides(
  (
    // Use Tremor content color for icons
    color: var(--ax-text-strong)
  )
);

// ===== Form Fields - Tailwind Zinc Style (visible borders) =====
.mat-mdc-form-field {
  // Outlined style - Use input-specific border for better visibility
  .mat-mdc-text-field-wrapper {
    .mat-mdc-form-field-flex {
      .mdc-notched-outline {
        .mdc-notched-outline__leading,
        .mdc-notched-outline__notch,
        .mdc-notched-outline__trailing {
          border-color: var(
            --ax-border-input,
            var(--ax-border-default)
          ) !important;
        }
      }
    }
  }

  // Hover state - Enhanced visibility
  &:hover:not(.mat-focused):not(.mat-form-field-disabled) {
    .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--ax-border-emphasis) !important;
      }
    }
  }

  // Focus state
  &.mat-focused {
    .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--ax-brand-default) !important;
        border-width: 2px !important;
      }
    }
  }

  // Error state
  &.mat-form-field-invalid {
    .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(
          --ax-error-default,
          var(--md-sys-color-error)
        ) !important;
      }
    }
  }

  // Disabled state
  &.mat-form-field-disabled {
    .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--ax-border-subtle) !important;
      }
    }
  }
}

// Fix faint left border on form field notch
.mat-mdc-form-field .mdc-notched-outline__notch {
  border-left: none !important;
}

// Input elements
.mat-mdc-input-element {
  color: var(--ax-text-strong) !important;

  &::placeholder {
    color: var(--ax-text-subtle) !important;
  }
}

// ===== Tables - Minimal Clean Style =====
@include mat.table-overrides(
  (
    // Background - Pure white/default (no gray backgrounds)
    background-color: transparent,
    // Borders - Use theme variables
    row-item-outline-color: var(--ax-border-default),
    row-item-outline-width: 1px,
    // Text colors - Use theme variables
    header-headline-color: var(--ax-text-strong),
    row-item-label-text-color: var(--ax-text-body)
  )
);

// Force override Material table CSS variables
:root {
  --mat-table-row-item-outline-color: var(--ax-border-default) !important;
  --mat-table-background-color: transparent !important;
  --mat-table-row-item-outline-width: 1px !important;
}

// Additional table styling - Minimal Material Design (subtle hierarchy)
.mat-mdc-table {
  border-radius: 0;
  overflow: auto;
  border: none;
  background: transparent !important;
  box-shadow: none !important; // Remove elevation shadow

  // Header - Pure white with subtle border
  .mat-mdc-header-row {
    background: transparent !important;
    border-bottom: 1px solid var(--ax-border-default);

    .mat-mdc-header-cell {
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--ax-text-strong);
      padding: 0.875rem 1rem;
      text-align: left;
      background: transparent !important;
    }
  }

  // Rows - Pure white, NO backgrounds, NO hover
  .mat-mdc-row {
    background: transparent !important;
    background-color: transparent !important;

    // Force remove zebra striping
    &:nth-child(odd),
    &:nth-child(even) {
      background: transparent !important;
      background-color: transparent !important;
    }

    // Remove hover effect
    &:hover {
      background: transparent !important;
      background-color: transparent !important;
    }

    .mat-mdc-cell {
      padding: 1rem; // p-4
      font-size: 0.875rem; // text-sm
      color: var(--ax-text-body);
      background: transparent !important;
      background-color: transparent !important;
    }
  }

  // Remove ALL vertical borders (Tremor uses divide-y only)
  .mat-mdc-cell,
  .mat-mdc-header-cell {
    border-right: none;
    border-left: none;
  }

  // Horizontal dividers between rows - Use theme variable
  .mat-mdc-row {
    border-bottom: 1px solid var(--ax-border-default);

    &:last-child {
      border-bottom: none;
    }
  }
}

// Remove table elevation shadows
.mat-mdc-table,
.mat-elevation-z8 {
  box-shadow: none !important;
}

// Paginator styling - Use theme background
.mat-mdc-paginator {
  background-color: var(--ax-background-default) !important;
  border-top: 1px solid var(--ax-border-default);
}

// ===== Chips - Minimal Style (Ultra Subtle Borders) =====
@include mat.chips-overrides(
  (
    // Outline (border) styling - Use theme variable
    outline-color: var(--ax-border-default),
    outline-width: 1px,

    // Container colors
    elevated-container-color: transparent,
    elevated-selected-container-color: var(--ax-brand-faint),
    elevated-disabled-container-color: var(--ax-background-subtle),
    // Label text colors
    label-text-color: var(--ax-text-strong),
    selected-label-text-color: var(--ax-brand-emphasis),
    disabled-label-text-color: var(--ax-text-subtle),
    // Disabled outline - Use theme variable
    disabled-outline-color: var(--ax-border-default),
    // Shape (border radius)
    container-shape-radius: var(--ax-radius-md),
    // Selected outline width
    flat-selected-outline-width: 1px
  )
);

// ===== Dialogs - Tremor Style =====
.mat-mdc-dialog-container {
  .mdc-dialog__surface {
    border-radius: var(--ax-radius-lg) !important;
    border: 1px solid var(--ax-border-default) !important;
    box-shadow: var(--ax-shadow-lg) !important;
    background: var(--ax-background-default) !important;
  }
}

// ===== Menus - Tremor Style =====
.mat-mdc-menu-panel {
  border: 1px solid var(--ax-border-default) !important;
  border-radius: var(--ax-radius-md) !important;
  box-shadow: var(--ax-shadow-md) !important;
  background: var(--ax-background-default) !important;
}

.mat-mdc-menu-item {
  &:hover:not([disabled]) {
    background: var(--ax-background-subtle) !important;
  }
}

// ===== Tabs - Tremor Style =====
.mat-mdc-tab-group {
  .mat-mdc-tab-header {
    border-bottom: 1px solid var(--ax-border-default);
  }

  .mat-mdc-tab {
    &:hover:not(.mat-mdc-tab-disabled) {
      background: var(--ax-background-subtle);
    }
  }

  .mat-mdc-tab-body-content {
    padding: var(--ax-spacing-lg);
  }
}

// Tab nav bar (standalone tabs like in docs)
.mat-mdc-tab-nav-bar {
  border-bottom: 1px solid var(--ax-border-default);

  .mat-mdc-tab-link {
    // Default (inactive) tab label - use secondary text color
    .mdc-tab__text-label {
      color: var(--ax-text-secondary) !important;
    }

    // Active tab label - use primary text color
    &.mdc-tab--active .mdc-tab__text-label {
      color: var(--ax-text-default) !important;
    }

    // Hover state
    &:hover:not(.mat-mdc-tab-disabled) .mdc-tab__text-label {
      color: var(--ax-text-default) !important;
    }
  }

  // Active indicator (ink bar)
  .mdc-tab-indicator__content--underline {
    border-color: var(--ax-brand-default) !important;
  }
}

// Also apply to regular tab group
.mat-mdc-tab-group {
  .mat-mdc-tab {
    .mdc-tab__text-label {
      color: var(--ax-text-secondary) !important;
    }

    &.mdc-tab--active .mdc-tab__text-label {
      color: var(--ax-text-default) !important;
    }

    &:hover:not(.mat-mdc-tab-disabled) .mdc-tab__text-label {
      color: var(--ax-text-default) !important;
    }
  }

  .mdc-tab-indicator__content--underline {
    border-color: var(--ax-brand-default) !important;
  }
}

// ===== Expansion Panels - Tremor Style =====
.mat-expansion-panel {
  border: 1px solid var(--ax-border-default) !important;
  border-radius: var(--ax-radius-md) !important;
  box-shadow: none !important;
  background: var(--ax-background-default) !important;

  & + .mat-expansion-panel {
    margin-top: var(--ax-spacing-sm);
  }

  &:not(.mat-expanded) {
    .mat-expansion-panel-header:hover {
      background: var(--ax-background-subtle) !important;
    }
  }
}

// ===== Progress Bars - Minimal =====
.mat-mdc-progress-bar {
  border-radius: var(--ax-radius-sm);
  overflow: hidden;
}

// ===== Sliders - Clean style =====
.mat-mdc-slider {
  .mdc-slider__track {
    border-radius: var(--ax-radius-sm);
  }
}

// ===== Toolbar - Tremor Style =====
.mat-toolbar {
  border-bottom: 1px solid var(--ax-border-default);
  box-shadow: var(--ax-shadow-sm);
}

// ===== Lists - Clean borders =====
.mat-mdc-list {
  .mat-mdc-list-item {
    border-bottom: 1px solid var(--ax-border-default);

    &:last-child {
      border-bottom: none;
    }

    &:hover:not([disabled]) {
      background: var(--ax-background-subtle);
    }
  }
}

// ===== Badges - Tremor Style =====
.mat-badge-content {
  border-radius: var(--ax-radius-sm);
  box-shadow: var(--ax-shadow-sm);
}

// ===== Tooltips - Minimal =====
.mat-mdc-tooltip {
  border-radius: var(--ax-radius-sm);
  box-shadow: var(--ax-shadow-md);
}

// ===== Snackbars - Tremor Style =====
.mat-mdc-snack-bar-container {
  border-radius: var(--ax-radius-md) !important;
  border: 1px solid var(--ax-border-default) !important;
  box-shadow: var(--ax-shadow-lg) !important;
}

// ===== Button Toggle - Tremor Style =====
.mat-button-toggle-group {
  box-shadow: none !important;
  border: 1px solid var(--ax-border-default) !important;
  border-radius: var(--ax-radius-md) !important;
  overflow: hidden;

  .mat-button-toggle {
    color: var(--ax-text-body);

    // Clean divider between buttons
    &:not(:last-child) {
      border-right: 1px solid var(--ax-border-default) !important;
    }

    // Remove Material's default borders except the divider
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
  }
}
