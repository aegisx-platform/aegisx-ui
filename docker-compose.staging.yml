version: '3.8'

services:
  postgres:
    environment:
      POSTGRES_DB: aegisx_db_staging
    container_name: aegisx_postgres_staging
    volumes:
      - postgres_data_staging:/var/lib/postgresql/data

  redis:
    container_name: aegisx_redis_staging
    volumes:
      - redis_data_staging:/data

  api:
    container_name: aegisx_api_staging
    environment:
      NODE_ENV: staging
      DATABASE_URL: postgresql://${POSTGRES_USER:-postgres}:${POSTGRES_PASSWORD}@postgres:5432/aegisx_db_staging
    ports:
      - "3001:3000"

  web:
    container_name: aegisx_web_staging
    environment:
      NODE_ENV: staging
    ports:
      - "3002:8080"

  admin:
    container_name: aegisx_admin_staging
    environment:
      NODE_ENV: staging
    ports:
      - "3003:8080"

volumes:
  postgres_data_staging:
    driver: local
  redis_data_staging:
    driver: local