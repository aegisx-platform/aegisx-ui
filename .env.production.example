# AegisX Production Environment Configuration
# Copy this file to .env.production and update with your production values

# ================================
# APPLICATION CONFIGURATION
# ================================
NODE_ENV=production
API_VERSION=v1
LOG_LEVEL=info

# ================================
# SERVER PORTS
# ================================
API_PORT=3000
WEB_PORT=80
ADMIN_PORT=8080
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# Monitoring and metrics ports
API_METRICS_PORT=9090
PROMETHEUS_PORT=9090
GRAFANA_PORT=3030

# ================================
# DATABASE CONFIGURATION
# ================================
# PostgreSQL Configuration
POSTGRES_USER=aegisx_user
POSTGRES_PASSWORD=CHANGE_THIS_SECURE_PASSWORD_123!
POSTGRES_DB=aegisx_production
POSTGRES_PORT=5432

# Database connection string (auto-generated from above)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# PostgreSQL Performance Tuning
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_WORK_MEM=4MB
POSTGRES_MAINTENANCE_WORK_MEM=64MB

# ================================
# REDIS CONFIGURATION
# ================================
REDIS_PASSWORD=CHANGE_THIS_REDIS_PASSWORD_456!
REDIS_PORT=6379
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# ================================
# SECURITY CONFIGURATION
# ================================
# JWT Configuration (CRITICAL: Change these in production)
JWT_SECRET=CHANGE_THIS_JWT_SECRET_TO_VERY_LONG_RANDOM_STRING_789!
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# CORS Configuration
CORS_ORIGIN=https://yourdomain.com,https://admin.yourdomain.com
CORS_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=15

# File Upload Configuration
UPLOAD_MAX_SIZE=5242880
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,application/pdf

# ================================
# SSL/TLS CONFIGURATION
# ================================
# SSL Certificate paths (if using custom certificates)
SSL_CERT_PATH=/etc/ssl/certs/aegisx.crt
SSL_KEY_PATH=/etc/ssl/private/aegisx.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Let's Encrypt configuration (if using certbot)
LETSENCRYPT_EMAIL=admin@yourdomain.com
LETSENCRYPT_DOMAINS=yourdomain.com,www.yourdomain.com,api.yourdomain.com,admin.yourdomain.com

# ================================
# MONITORING CONFIGURATION
# ================================
PROMETHEUS_ENABLED=true
GRAFANA_ADMIN_PASSWORD=CHANGE_THIS_GRAFANA_PASSWORD_000!

# Alert configurations
WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
ALERT_EMAIL=admin@yourdomain.com
ALERT_THRESHOLD=3

# ================================
# BACKUP CONFIGURATION
# ================================
RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM

# S3 Backup Configuration (optional)
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_S3_BUCKET=aegisx-backups
AWS_REGION=us-east-1

# ================================
# VOLUME PATHS
# ================================
# Data directories (absolute paths recommended)
POSTGRES_DATA_PATH=/opt/aegisx/data/postgres
POSTGRES_BACKUP_PATH=/opt/aegisx/backups/postgres
REDIS_DATA_PATH=/opt/aegisx/data/redis
REDIS_LOGS_PATH=/opt/aegisx/logs/redis

# Application directories
API_LOGS_PATH=/opt/aegisx/logs/api
API_UPLOADS_PATH=/opt/aegisx/uploads
WEB_LOGS_PATH=/opt/aegisx/logs/web
ADMIN_LOGS_PATH=/opt/aegisx/logs/admin

# Nginx directories
NGINX_LOGS_PATH=/opt/aegisx/logs/nginx
NGINX_CACHE_PATH=/opt/aegisx/cache/nginx

# ================================
# SCALING CONFIGURATION
# ================================
# Container replica counts
API_REPLICAS=1
WEB_REPLICAS=1
ADMIN_REPLICAS=1

# Resource limits (optional, for Docker Swarm)
API_MEMORY_LIMIT=1g
API_CPU_LIMIT=1.0
WEB_MEMORY_LIMIT=256m
WEB_CPU_LIMIT=0.5

# ================================
# EXTERNAL SERVICES
# ================================
# Email Service Configuration (SMTP)
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=your_smtp_password
SMTP_FROM=noreply@yourdomain.com

# CDN Configuration (optional)
CDN_URL=https://cdn.yourdomain.com
CDN_ACCESS_KEY=your_cdn_access_key
CDN_SECRET_KEY=your_cdn_secret_key

# Payment Gateway (if applicable)
STRIPE_PUBLIC_KEY=pk_live_your_stripe_public_key
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# ================================
# FEATURE FLAGS
# ================================
ENABLE_REGISTRATION=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_SOCIAL_LOGIN=false
ENABLE_ADMIN_PANEL=true
ENABLE_API_DOCS=false
ENABLE_METRICS=true
ENABLE_HEALTH_CHECKS=true

# ================================
# DEVELOPMENT/DEBUG (Production: set to false)
# ================================
DEBUG=false
ENABLE_SWAGGER=false
ENABLE_CORS_DEBUG=false
ENABLE_SQL_LOGGING=false

# ================================
# DOMAIN CONFIGURATION
# ================================
# Primary domain
PRIMARY_DOMAIN=yourdomain.com
API_DOMAIN=api.yourdomain.com
ADMIN_DOMAIN=admin.yourdomain.com
CDN_DOMAIN=cdn.yourdomain.com

# ================================
# THIRD-PARTY INTEGRATIONS
# ================================
# Analytics
GOOGLE_ANALYTICS_ID=GA_MEASUREMENT_ID
MIXPANEL_TOKEN=your_mixpanel_token

# Social Authentication
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret

# ================================
# ENVIRONMENT VALIDATION
# ================================
# This section helps validate environment setup
REQUIRED_SECRETS="POSTGRES_PASSWORD,REDIS_PASSWORD,JWT_SECRET,GRAFANA_ADMIN_PASSWORD"
OPTIONAL_SECRETS="AWS_SECRET_ACCESS_KEY,STRIPE_SECRET_KEY,SMTP_PASSWORD"

# Production readiness checklist
CHECKLIST_SSL_CONFIGURED=false
CHECKLIST_BACKUP_TESTED=false
CHECKLIST_MONITORING_SETUP=false
CHECKLIST_SECRETS_ROTATED=false
CHECKLIST_PERFORMANCE_TESTED=false

# ================================
# NOTES
# ================================
# 1. All passwords marked with "CHANGE_THIS" MUST be updated before production use
# 2. Use environment variable substitution where possible
# 3. Store sensitive values in Docker secrets or external secret management
# 4. Regularly rotate passwords and secrets
# 5. Test backup and restore procedures before going live
# 6. Configure proper SSL certificates for HTTPS
# 7. Set up monitoring alerts for production issues
# 8. Review and update CORS origins for your specific domains
# 9. Configure proper log rotation and retention policies
# 10. Test disaster recovery procedures

# ================================
# SECURITY REMINDERS
# ================================
# - Never commit this file with real secrets to version control
# - Use Docker secrets or HashiCorp Vault for sensitive data
# - Implement proper secret rotation policies  
# - Monitor for credential leaks in logs and backups
# - Use principle of least privilege for all services
# - Enable audit logging for security events
# - Regularly update container images and dependencies
# - Configure proper network segmentation and firewall rules