openapi: 3.0.3
info:
  title: AegisX Platform API
  description: |
    Complete API specification for the AegisX Platform including all UI library endpoints.

    This API provides comprehensive functionality for:
    - Authentication and session management
    - User profile and preferences management  
    - Navigation structure and menu management
    - Application settings and themes

    ## Authentication

    Most endpoints require authentication via JWT Bearer tokens. Include the token in the Authorization header:
    ```
    Authorization: Bearer <your_jwt_token>
    ```

    ## Error Handling

    All API responses follow a consistent format with a `success` boolean and standardized error structure.

    ## Rate Limiting

    API requests are rate limited to prevent abuse. Rate limit headers are included in responses.

  version: 1.0.0
  contact:
    name: AegisX Platform Team
    url: https://github.com/aegisx-platform
    email: support@aegisx.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://aegisx.com/terms

servers:
  - url: http://localhost:3000/api
    description: Development server
  - url: https://staging-api.aegisx.com
    description: Staging server
  - url: https://api.aegisx.com
    description: Production server

security:
  - bearerAuth: []

paths:
  # Authentication Endpoints
  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout user
      description: Logout the current authenticated user and invalidate their session/tokens
      operationId: logoutUser
      security:
        - bearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                allDevices:
                  type: boolean
                  description: Logout from all devices/sessions
                  default: false
      responses:
        '200':
          description: User logged out successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          message:
                            type: string
                            example: 'Successfully logged out'
                          loggedOutDevices:
                            type: integer
                            example: 1
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: Refresh the access token using a valid refresh token
      operationId: refreshToken
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  description: Valid refresh token
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/AuthTokens'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /auth/me:
    get:
      tags:
        - Authentication
      summary: Get current authenticated user
      description: Retrieve information about the currently authenticated user
      operationId: getCurrentUser
      responses:
        '200':
          description: Current user information retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/AuthenticatedUser'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Navigation Endpoints
  /navigation:
    get:
      tags:
        - Navigation
      summary: Get navigation structure
      description: Retrieve the complete navigation structure including default, compact, horizontal, and mobile navigation arrays
      operationId: getNavigation
      parameters:
        - name: type
          in: query
          description: Type of navigation to retrieve
          required: false
          schema:
            type: string
            enum: [default, compact, horizontal, mobile]
            default: default
        - name: includeDisabled
          in: query
          description: Include disabled navigation items
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Navigation structure retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/NavigationResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /navigation/user:
    get:
      tags:
        - Navigation
      summary: Get user-specific navigation
      description: Retrieve navigation structure filtered by user permissions and preferences
      operationId: getUserNavigation
      parameters:
        - name: type
          in: query
          description: Type of navigation to retrieve
          schema:
            type: string
            enum: [default, compact, horizontal, mobile]
            default: default
      responses:
        '200':
          description: User navigation structure retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/NavigationResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # User Profile Endpoints
  /users/profile:
    get:
      tags:
        - User Profile
      summary: Get current user profile
      description: Retrieve the current authenticated user's profile information
      operationId: getUserProfile
      responses:
        '200':
          description: User profile retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserProfile'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - User Profile
      summary: Update current user profile
      description: Update the current authenticated user's profile information
      operationId: updateUserProfile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserProfileUpdateRequest'
      responses:
        '200':
          description: User profile updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserProfile'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /users/avatar:
    post:
      tags:
        - User Profile
      summary: Upload user avatar
      description: Upload and set a new avatar image for the current user
      operationId: uploadUserAvatar
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Avatar image file (JPEG, PNG, WebP)
      responses:
        '200':
          description: Avatar uploaded successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          avatar:
                            type: string
                            format: uri
                            example: 'https://api.aegisx.com/avatars/usr_123456789.jpg'
                          thumbnails:
                            type: object
                            properties:
                              small:
                                type: string
                                format: uri
                              medium:
                                type: string
                                format: uri
                              large:
                                type: string
                                format: uri
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '413':
          $ref: '#/components/responses/FileTooLargeError'
        '415':
          $ref: '#/components/responses/UnsupportedMediaTypeError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - User Profile
      summary: Delete user avatar
      description: Remove the current user's avatar image
      operationId: deleteUserAvatar
      responses:
        '200':
          description: Avatar deleted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          message:
                            type: string
                            example: 'Avatar deleted successfully'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  # Settings Endpoints
  /settings:
    get:
      tags:
        - Settings
      summary: Get all user settings
      description: Retrieve all settings for the current authenticated user
      operationId: getAllSettings
      responses:
        '200':
          description: Settings retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserSettings'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Settings
      summary: Update user settings
      description: Update multiple settings for the current authenticated user
      operationId: updateSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserSettingsUpdateRequest'
      responses:
        '200':
          description: Settings updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserSettings'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /settings/theme:
    get:
      tags:
        - Settings
        - Theme
      summary: Get theme settings
      description: Retrieve theme-specific settings for the current user
      operationId: getThemeSettings
      responses:
        '200':
          description: Theme settings retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ThemeSettings'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Settings
        - Theme
      summary: Update theme settings
      description: Update theme-specific settings for the current user
      operationId: updateThemeSettings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ThemeSettingsUpdateRequest'
      responses:
        '200':
          description: Theme settings updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ThemeSettings'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer token authentication

  schemas:
    # Common Response Schemas
    ApiResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Indicates if the request was successful
        meta:
          $ref: '#/components/schemas/ApiMeta'

    ApiMeta:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
          description: Timestamp of the response
        version:
          type: string
          description: API version
        requestId:
          type: string
          description: Unique request identifier for tracing

    # Authentication Schemas
    AuthTokens:
      type: object
      required:
        - accessToken
        - refreshToken
        - tokenType
        - expiresIn
      properties:
        accessToken:
          type: string
          description: JWT access token
          example: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...'
        refreshToken:
          type: string
          description: JWT refresh token
          example: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...'
        tokenType:
          type: string
          enum: [Bearer]
          description: Token type
          example: 'Bearer'
        expiresIn:
          type: integer
          description: Access token expiration time in seconds
          example: 3600
        refreshExpiresIn:
          type: integer
          description: Refresh token expiration time in seconds
          example: 86400

    AuthenticatedUser:
      type: object
      required:
        - id
        - email
        - name
        - role
        - status
      properties:
        id:
          type: string
          description: Unique user identifier
          example: 'usr_123456789'
        email:
          type: string
          format: email
          description: User's email address
          example: 'john.doe@example.com'
        name:
          type: string
          description: User's full name
          example: 'John Doe'
        firstName:
          type: string
          description: User's first name
          example: 'John'
        lastName:
          type: string
          description: User's last name
          example: 'Doe'
        avatar:
          type: string
          format: uri
          nullable: true
          description: URL of the user's avatar image
          example: 'https://api.aegisx.com/avatars/usr_123456789.jpg'
        role:
          $ref: '#/components/schemas/UserRole'
        status:
          type: string
          enum: [active, inactive, suspended, pending]
          description: User account status
          example: 'active'
        emailVerified:
          type: boolean
          description: Whether the user's email is verified
        twoFactorEnabled:
          type: boolean
          description: Whether two-factor authentication is enabled
        lastLoginAt:
          type: string
          format: date-time
          nullable: true
          description: Last login timestamp
        createdAt:
          type: string
          format: date-time
          description: User creation timestamp

    UserRole:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          description: Role identifier
          example: 'role_admin'
        name:
          type: string
          description: Role display name
          example: 'Administrator'
        permissions:
          type: array
          items:
            type: string
          description: List of permissions granted by this role
          example:
            ['users.view', 'users.create', 'users.update', 'users.delete']

    # Navigation Schemas
    NavigationResponse:
      type: object
      properties:
        default:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Default navigation structure
        compact:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Compact navigation structure
        horizontal:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Horizontal navigation structure
        mobile:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Mobile navigation structure

    NavigationItem:
      type: object
      required:
        - id
        - title
        - type
      properties:
        id:
          type: string
          description: Unique identifier for the navigation item
          example: 'dashboard'
        title:
          type: string
          description: Display title for the navigation item
          example: 'Dashboard'
        type:
          type: string
          enum: [item, group, collapsible, divider, spacer]
          description: Type of navigation item
          example: 'item'
        icon:
          type: string
          description: Icon identifier (Heroicons, Material, etc.)
          example: 'heroicons_outline:chart-pie'
        link:
          type: string
          description: Navigation link/route
          example: '/dashboard'
        disabled:
          type: boolean
          description: Whether the navigation item is disabled
          default: false
        hidden:
          type: boolean
          description: Whether the navigation item is hidden
          default: false
        permissions:
          type: array
          items:
            type: string
          description: Required permissions to view this navigation item
          example: ['dashboard.view']
        children:
          type: array
          items:
            $ref: '#/components/schemas/NavigationItem'
          description: Child navigation items (for collapsible/group types)

    # User Profile Schemas
    UserProfile:
      type: object
      required:
        - id
        - email
        - name
        - role
        - status
      properties:
        id:
          type: string
          description: Unique user identifier
          example: 'usr_123456789'
        email:
          type: string
          format: email
          description: User's email address
          example: 'john.doe@example.com'
        name:
          type: string
          description: User's full name
          example: 'John Doe'
        firstName:
          type: string
          description: User's first name
          example: 'John'
        lastName:
          type: string
          description: User's last name
          example: 'Doe'
        avatar:
          type: string
          format: uri
          nullable: true
          description: URL of the user's avatar image
          example: 'https://api.aegisx.com/avatars/usr_123456789.jpg'
        role:
          $ref: '#/components/schemas/UserRole'
        preferences:
          $ref: '#/components/schemas/UserPreferences'
        createdAt:
          type: string
          format: date-time
          description: User creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last profile update timestamp
        lastLoginAt:
          type: string
          format: date-time
          nullable: true
          description: Last login timestamp
        status:
          type: string
          enum: [active, inactive, suspended, pending]
          description: User account status
          example: 'active'

    UserPreferences:
      type: object
      properties:
        theme:
          type: string
          enum: [default, dark, light, auto]
          description: UI theme preference
          default: 'default'
        scheme:
          type: string
          enum: [light, dark, auto]
          description: Color scheme preference
          default: 'light'
        layout:
          type: string
          enum: [classic, compact, enterprise, empty]
          description: Layout preference
          default: 'classic'
        language:
          type: string
          description: Language preference (ISO 639-1 code)
          example: 'en'
        timezone:
          type: string
          description: Timezone preference (IANA timezone)
          example: 'UTC'
        notifications:
          $ref: '#/components/schemas/NotificationPreferences'

    NotificationPreferences:
      type: object
      properties:
        email:
          type: boolean
          description: Enable email notifications
          default: true
        push:
          type: boolean
          description: Enable push notifications
          default: false
        desktop:
          type: boolean
          description: Enable desktop notifications
          default: true

    UserProfileUpdateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: User's full name
        firstName:
          type: string
          minLength: 1
          maxLength: 50
          description: User's first name
        lastName:
          type: string
          minLength: 1
          maxLength: 50
          description: User's last name
        preferences:
          $ref: '#/components/schemas/UserPreferences'

    # Settings Schemas
    UserSettings:
      type: object
      properties:
        theme:
          $ref: '#/components/schemas/ThemeSettings'
        layout:
          $ref: '#/components/schemas/LayoutSettings'
        localization:
          $ref: '#/components/schemas/LocalizationSettings'
        notifications:
          $ref: '#/components/schemas/NotificationSettings'

    ThemeSettings:
      type: object
      properties:
        name:
          type: string
          enum: [default, dark, light, minimal, enterprise]
          description: Theme name
          default: 'default'
        scheme:
          type: string
          enum: [light, dark, auto]
          description: Color scheme
          default: 'light'
        customColors:
          type: object
          properties:
            primary:
              type: string
              pattern: '^#[0-9A-Fa-f]{6}$'
              description: Primary color (hex)
              example: '#1976d2'
            accent:
              type: string
              pattern: '^#[0-9A-Fa-f]{6}$'
              description: Accent color (hex)
              example: '#ff4081'
        darkMode:
          type: boolean
          description: Enable dark mode
          default: false
        autoTheme:
          type: boolean
          description: Automatically switch theme based on system preference
          default: false

    LayoutSettings:
      type: object
      properties:
        type:
          type: string
          enum: [classic, compact, enterprise, empty]
          description: Layout type
          default: 'classic'
        navigation:
          $ref: '#/components/schemas/NavigationSettings'

    NavigationSettings:
      type: object
      properties:
        type:
          type: string
          enum: [default, compact, horizontal]
          description: Navigation type
          default: 'default'
        position:
          type: string
          enum: [left, right, top]
          description: Navigation position
          default: 'left'
        collapsed:
          type: boolean
          description: Navigation collapsed state
          default: false

    LocalizationSettings:
      type: object
      properties:
        language:
          type: string
          pattern: '^[a-z]{2}$'
          description: Language code (ISO 639-1)
          example: 'en'
        timezone:
          type: string
          description: Timezone (IANA timezone)
          example: 'UTC'
        dateFormat:
          type: string
          enum: [MM/DD/YYYY, DD/MM/YYYY, YYYY-MM-DD]
          description: Date format preference

    NotificationSettings:
      type: object
      properties:
        email:
          type: boolean
          description: Enable email notifications
          default: true
        push:
          type: boolean
          description: Enable push notifications
          default: false
        desktop:
          type: boolean
          description: Enable desktop notifications
          default: true

    UserSettingsUpdateRequest:
      type: object
      properties:
        theme:
          $ref: '#/components/schemas/ThemeSettingsUpdateRequest'
        layout:
          $ref: '#/components/schemas/LayoutSettings'
        localization:
          $ref: '#/components/schemas/LocalizationSettings'
        notifications:
          $ref: '#/components/schemas/NotificationSettings'

    ThemeSettingsUpdateRequest:
      type: object
      properties:
        name:
          type: string
          enum: [default, dark, light, minimal, enterprise]
        scheme:
          type: string
          enum: [light, dark, auto]
        customColors:
          type: object
          properties:
            primary:
              type: string
              pattern: '^#[0-9A-Fa-f]{6}$'
            accent:
              type: string
              pattern: '^#[0-9A-Fa-f]{6}$'
        darkMode:
          type: boolean
        autoTheme:
          type: boolean

    # Error Schemas
    ApiError:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          required:
            - code
            - message
          properties:
            code:
              type: string
              description: Error code identifier
            message:
              type: string
              description: Human-readable error message
            details:
              type: object
              additionalProperties: true
              description: Additional error details
            field:
              type: string
              description: Field that caused the error

    ValidationError:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          required:
            - code
            - message
          properties:
            code:
              type: string
              example: 'VALIDATION_ERROR'
            message:
              type: string
              example: 'Validation failed'
            details:
              type: array
              items:
                type: object
                properties:
                  field:
                    type: string
                  message:
                    type: string
                  code:
                    type: string

  responses:
    # Success Responses
    SuccessResponse:
      description: Request completed successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiResponse'

    # Error Responses
    BadRequestError:
      description: Bad request - invalid input
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'BAD_REQUEST'
              message: 'Invalid request format or parameters'

    UnauthorizedError:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'UNAUTHORIZED'
              message: 'Authentication required'

    ForbiddenError:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'FORBIDDEN'
              message: 'Insufficient permissions'

    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'NOT_FOUND'
              message: 'Requested resource not found'

    ValidationError:
      description: Validation error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ValidationError'

    FileTooLargeError:
      description: File size exceeds limit
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'FILE_TOO_LARGE'
              message: 'File size exceeds maximum limit'

    UnsupportedMediaTypeError:
      description: Unsupported media type
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'UNSUPPORTED_MEDIA_TYPE'
              message: 'Media type not supported'

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'
          example:
            success: false
            error:
              code: 'INTERNAL_SERVER_ERROR'
              message: 'An unexpected error occurred'

tags:
  - name: Authentication
    description: Authentication and session management endpoints
  - name: Navigation
    description: Navigation structure and menu management
  - name: User Profile
    description: User profile and preferences management
  - name: Settings
    description: Application settings and configuration
  - name: Theme
    description: Theme and appearance settings

externalDocs:
  description: AegisX Platform Documentation
  url: https://docs.aegisx.com
