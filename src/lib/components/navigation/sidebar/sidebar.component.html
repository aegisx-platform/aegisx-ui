<aside [class]="sidebarClasses">
  <div class="ax-sidebar-header">
    <ng-content select="[header]"></ng-content>
    <button
      type="button"
      class="ax-sidebar-toggle"
      (click)="toggleCollapsed()"
      aria-label="Toggle sidebar"
    >
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          d="M15 18l-6-6 6-6"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
  </div>

  <nav class="ax-sidebar-nav">
    <ul class="ax-sidebar-items">
      @for (item of items; track trackByIndex($index)) {
        <li class="ax-sidebar-item">
          <a
            [href]="item.url || '#'"
            class="ax-sidebar-link"
            [class.ax-sidebar-link-active]="item.active"
            (click)="
              item.children && item.children.length > 0
                ? toggleExpanded($index)
                : onItemClick(item)
            "
          >
            @if (item.icon) {
              <span class="ax-sidebar-icon">{{ item.icon }}</span>
            }
            @if (!collapsed) {
              <span class="ax-sidebar-label">{{ item.label }}</span>
              @if (item.children && item.children.length > 0) {
                <svg
                  class="ax-sidebar-arrow"
                  [class.ax-sidebar-arrow-expanded]="isExpanded($index)"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M9 18l6-6-6-6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              }
            }
          </a>

          @if (
            item.children &&
            item.children.length > 0 &&
            isExpanded($index) &&
            !collapsed
          ) {
            <ul class="ax-sidebar-submenu">
              @for (child of item.children; track trackByIndex($index)) {
                <li>
                  <a
                    [href]="child.url || '#'"
                    class="ax-sidebar-link ax-sidebar-link-child"
                    [class.ax-sidebar-link-active]="child.active"
                    (click)="onItemClick(child)"
                  >
                    @if (child.icon) {
                      <span class="ax-sidebar-icon">{{ child.icon }}</span>
                    }
                    <span class="ax-sidebar-label">{{ child.label }}</span>
                  </a>
                </li>
              }
            </ul>
          }
        </li>
      }
    </ul>
  </nav>

  <div class="ax-sidebar-footer">
    <ng-content select="[footer]"></ng-content>
  </div>
</aside>
