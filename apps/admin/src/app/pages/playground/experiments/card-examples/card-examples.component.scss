/* ============================================
   KPI Cards - Styles moved to aegisx-ui library
   See: libs/aegisx-ui/src/lib/styles/components/_kpi-cards.scss
   ============================================ */

// ============================================
// Progress Distribution Cards
// ============================================
.kpi-card-progress {
  background: var(--ax-background-default);
  border: 1px solid var(--ax-border-default) !important;
  border-radius: 8px;
  transition: all 0.2s ease;
  box-shadow: none !important;

  &:hover {
    border-color: var(--ax-text-secondary) !important;
    box-shadow: var(--ax-shadow-sm) !important;
  }

  mat-card-content {
    padding: 1.5rem !important;
  }
}

.progress-label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--ax-text-secondary);
  margin: 0 0 0.5rem 0;
}

.progress-value {
  font-size: 1.875rem;
  font-weight: 600;
  color: var(--ax-text-heading);
  margin: 0 0 1rem 0;
  line-height: 1.2;
}

// Segmented Progress Bar
.progress-bar-container {
  display: flex;
  gap: 2px;
  width: 100%;
  height: 8px;
  margin-bottom: 1rem;
  border-radius: 4px;
  overflow: hidden;
  background: var(--ax-background-subtle);
}

.progress-segment {
  height: 100%;
  transition: width 0.3s ease;

  &:first-child {
    border-radius: 4px 0 0 4px;
  }

  &:last-child {
    border-radius: 0 4px 4px 0;
  }

  &.progress-primary {
    background: var(--ax-info-default); // Blue for primary/good metrics
  }

  &.progress-muted {
    background: var(--ax-text-subtle); // Gray for in-progress/neutral
  }

  &.progress-error {
    background: var(--md-sys-error); // Red for errors/bad metrics
  }

  &.progress-cyan {
    background: var(--ax-cyan-default); // Cyan for completion/output
  }

  &.progress-indigo {
    background: var(--ax-indigo-default); // Indigo for prompt/input
  }
}

// Legend
.progress-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;

  &.legend-primary {
    background: var(--ax-info-default);
  }

  &.legend-muted {
    background: var(--ax-text-subtle);
  }

  &.legend-error {
    background: var(--md-sys-error);
  }

  &.legend-cyan {
    background: var(--ax-cyan-default);
  }

  &.legend-indigo {
    background: var(--ax-indigo-default);
  }
}

.legend-text {
  font-size: 0.75rem;
  font-weight: 400;
  color: var(--ax-text-secondary);
  white-space: nowrap;
}

// ============================================
// Usage/Quota Cards
// ============================================
.kpi-card-quota {
  background: var(--ax-background-default);
  border: 1px solid var(--ax-border-default) !important;
  border-radius: 8px;
  transition: all 0.2s ease;
  box-shadow: none !important;

  &:hover {
    border-color: var(--ax-text-secondary) !important;
    box-shadow: var(--ax-shadow-sm) !important;
  }

  mat-card-content {
    padding: 1.5rem !important;
  }
}

.quota-label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--ax-text-secondary);
  margin: 0 0 0.5rem 0;
}

.quota-value {
  font-size: 1.875rem;
  font-weight: 600;
  color: var(--ax-text-heading);
  margin: 0 0 1rem 0;
  line-height: 1.2;
}

// Single Progress Bar (with track and fill)
.quota-bar-container {
  margin-bottom: 0.75rem;
}

.quota-bar-track {
  width: 100%;
  height: 8px;
  background: var(--ax-info-faint); // Light blue background
  border-radius: 4px;
  overflow: hidden;
}

.quota-bar-fill {
  height: 100%;
  background: var(--ax-info-default); // Blue fill
  border-radius: 4px;
  transition: width 0.3s ease;
}

// Stats Row
.quota-stats {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.quota-percentage {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--ax-info-default); // Blue to match progress bar
}

.quota-total {
  font-size: 0.875rem;
  font-weight: 400;
  color: var(--ax-text-secondary);
}

// Best Practices List
.best-practices-list {
  list-style: none;
  padding: 0;
  margin: 0;

  li {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--ax-border-default);

    &:last-child {
      border-bottom: none;
    }

    mat-icon {
      flex-shrink: 0;
      margin-top: 0.125rem;

      &.success-icon {
        color: var(--ax-success-default);
      }
    }

    code {
      font-size: 0.8125rem;
      padding: 0.125rem 0.375rem;
      background: var(--ax-background-subtle);
      border-radius: 4px;
      color: var(--ax-text-primary);
      border: 1px solid var(--ax-border-default);
    }
  }
}

// ============================================
// Trend Cards with Sparklines
// ============================================
.kpi-card-trend {
  background: var(--ax-background-default);
  border: 1px solid var(--ax-border-default) !important;
  border-radius: 8px;
  transition: all 0.2s ease;
  box-shadow: none !important;

  &:hover {
    border-color: var(--ax-text-secondary) !important;
    box-shadow: var(--ax-shadow-sm) !important;
  }

  mat-card-content {
    padding: 1.5rem !important;
  }
}

.trend-label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--ax-text-secondary);
  margin: 0 0 0.5rem 0;
}

.trend-value {
  font-size: 1.875rem;
  font-weight: 600;
  color: var(--ax-text-heading);
  margin: 0 0 0.75rem 0;
  line-height: 1.2;
}

.trend-meta {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 1rem;
  font-size: 0.875rem;
}

.trend-date {
  color: var(--ax-text-secondary);
  font-weight: 400;
}

.trend-change {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  font-weight: 500;

  &.trend-positive {
    color: var(--ax-success-default); // Green for positive trends
  }

  &.trend-negative {
    color: var(--md-sys-error); // Red for negative trends
  }
}

// Sparkline Chart Container
.sparkline-container {
  height: 64px;
  margin-bottom: 0.75rem;
  position: relative;

  canvas {
    width: 100% !important;
    height: 100% !important;
  }
}

// Trend Period Labels
.trend-period {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.75rem;
  font-weight: 400;
  color: var(--ax-text-subtle);
}

// ============================================
// SVG Circle/Ring Colors - Dark Mode Support
// ============================================
.svg-stroke-track {
  stroke: var(--ax-border-default);
}

.svg-stroke-info {
  stroke: var(--ax-info-default);
}

.svg-stroke-info-muted {
  stroke: var(--ax-info-muted);
}

.svg-stroke-info-faint {
  stroke: var(--ax-info-faint);
}

// ============================================
// Material Progress Bar - Tremor Style
// Direct height approach (no transform)
// ============================================
::ng-deep {
  .kpi-card {
    mat-progress-bar {
      --mdc-linear-progress-track-height: 10px;
      --mdc-linear-progress-active-indicator-height: 10px;
      --mdc-linear-progress-active-indicator-color: var(--ax-info-default);
      --mdc-linear-progress-track-color: var(--ax-info-faint);

      display: block;
      height: 10px !important;
      border-radius: 999px !important;
      overflow: hidden !important;

      * {
        height: 10px !important;
      }

      .mdc-linear-progress {
        height: 10px !important;
        border-radius: 999px !important;
        overflow: hidden !important;
      }

      .mdc-linear-progress__bar-inner {
        border-top-width: 10px !important;
        border-top-style: solid !important;
        border-top-color: var(--ax-info-default) !important;
      }

      .mdc-linear-progress__buffer {
        height: 10px !important;
        background-color: var(--ax-info-faint) !important;
      }

      .mdc-linear-progress__buffer-bar {
        background-color: var(--ax-info-faint) !important;
        height: 10px !important;
      }

      .mdc-linear-progress__bar {
        height: 10px !important;
      }

      .mdc-linear-progress__primary-bar,
      .mdc-linear-progress__secondary-bar {
        height: 10px !important;
      }
    }
  }

  // Color Variants
  mat-progress-bar {
    &.progress-success {
      .mdc-linear-progress__buffer {
        background-color: var(--ax-success-faint) !important; // Light green
      }
      .mdc-linear-progress__bar-inner {
        background-color: var(--ax-success-default) !important; // Green
      }
    }

    &.progress-warning {
      .mdc-linear-progress__buffer {
        background-color: var(--ax-warning-faint) !important; // Light yellow
      }
      .mdc-linear-progress__bar-inner {
        background-color: var(--ax-warning-default) !important; // Yellow/Orange
      }
    }

    &.progress-critical {
      .mdc-linear-progress__buffer {
        background-color: var(--ax-error-faint) !important; // Light red
      }
      .mdc-linear-progress__bar-inner {
        background-color: var(--md-sys-error) !important; // Red
      }
    }

    &.progress-neutral {
      .mdc-linear-progress__buffer {
        background-color: var(--ax-background-subtle) !important; // Light gray
      }
      .mdc-linear-progress__bar-inner {
        background-color: var(--ax-info-default) !important; // Blue
      }
    }
  }
}

// Responsive Adjustments
@media (max-width: 768px) {
  .kpi-value {
    font-size: 1.5rem;
  }

  .kpi-icon {
    width: 36px;
    height: 36px;

    mat-icon {
      font-size: 18px;
      width: 18px;
      height: 18px;
    }
  }

  .kpi-card {
    mat-card-content {
      padding: 1.25rem !important;
    }
  }

  .trend-value {
    font-size: 1.5rem;
  }

  .sparkline-container {
    height: 48px;
  }
}
