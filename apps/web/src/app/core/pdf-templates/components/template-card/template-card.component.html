<ax-card variant="outlined" size="md" [hoverable]="true" class="h-full">
  <!-- Card Header -->
  <div class="flex items-start justify-between mb-4">
    <div class="flex-1 min-w-0">
      <div class="flex items-center gap-2 mb-1 flex-wrap">
        <!-- Checkbox for bulk selection -->
        @if (disabled === false) {
          <input
            type="checkbox"
            [checked]="selected"
            (change)="selectionChange.emit()"
            class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
            (click)="$event.stopPropagation()"
          />
        }

        <h3 class="text-lg font-semibold truncate">
          {{ template.display_name }}
        </h3>

        @if (template.is_template_starter) {
          <ax-badge variant="soft" type="warning" size="sm">
            <mat-icon class="text-xs">stars</mat-icon>
            Starter
          </ax-badge>
        }
        @if (template.is_default) {
          <ax-badge variant="soft" type="info" size="sm"> Default </ax-badge>
        }
      </div>
      <p class="text-sm text-gray-600 dark:text-gray-400 font-mono truncate">
        {{ template.name }}
      </p>
    </div>
    <ax-badge
      [variant]="template.is_active ? 'soft' : 'outlined'"
      [type]="template.is_active ? 'success' : 'error'"
      size="sm"
      class="ml-2 flex-shrink-0"
    >
      {{ template.is_active ? 'Active' : 'Inactive' }}
    </ax-badge>
  </div>

  <!-- Card Body: Fields -->
  <div class="space-y-3 mb-4">
    <ax-field-display
      label="Category"
      [value]="template.category || '-'"
      size="sm"
    ></ax-field-display>

    <ax-field-display
      label="Type"
      [value]="template.type || '-'"
      size="sm"
    ></ax-field-display>

    @if (template.usage_count && template.usage_count > 0) {
      <div class="flex items-center justify-between py-2">
        <span class="text-sm text-gray-600 dark:text-gray-400"
          >Usage Count</span
        >
        <div class="flex items-center gap-1">
          <mat-icon class="text-blue-500 text-base">trending_up</mat-icon>
          <span class="text-sm font-medium">{{ template.usage_count }}</span>
        </div>
      </div>
    }
  </div>

  <!-- Card Footer: Date + Actions -->
  <div
    class="flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700"
  >
    <span class="text-xs text-gray-500 dark:text-gray-400">
      {{ template.created_at | date: 'short' }}
    </span>
    <div class="flex gap-1">
      <button
        mat-icon-button
        (click)="preview.emit(template); $event.stopPropagation()"
        matTooltip="Preview"
        color="primary"
        class="scale-90"
      >
        <mat-icon>visibility</mat-icon>
      </button>
      <button
        mat-icon-button
        [matMenuTriggerFor]="menu"
        matTooltip="More actions"
        (click)="$event.stopPropagation()"
        class="scale-90"
      >
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="edit.emit(template)">
          <mat-icon>edit</mat-icon>
          <span>Edit</span>
        </button>
        <button mat-menu-item (click)="duplicate.emit(template)">
          <mat-icon>content_copy</mat-icon>
          <span>Duplicate</span>
        </button>
        <mat-divider></mat-divider>
        <button
          mat-menu-item
          (click)="delete.emit(template)"
          class="text-red-600 dark:text-red-400"
        >
          <mat-icon color="warn">delete</mat-icon>
          <span>Delete</span>
        </button>
      </mat-menu>
    </div>
  </div>
</ax-card>
