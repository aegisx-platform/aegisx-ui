/**
 * Material Design Fixes and Overrides
 * 
 * This file contains fixes and customizations for Angular Material components
 * to work better with our design system and resolve common issues.
 */

/* ==========================================================================
   Angular Material Form Field Fixes
   ========================================================================== */

.mat-mdc-form-field {
  width: 100%;
}

/* Fix Material Design 3 Input Styles */
.mat-mdc-text-field-wrapper {
  background-color: transparent !important;
}

/* Override Fuse/Ax border styles for Material components */
.mat-mdc-form-field,
.mat-mdc-form-field *,
.mat-mdc-text-field-wrapper,
.mat-mdc-text-field-wrapper *,
.mdc-text-field,
.mdc-text-field *,
.mdc-notched-outline,
.mdc-notched-outline *,
.mdc-line-ripple {
  --tw-border-opacity: initial !important;
}

/* Remove any conflicting border from Material inputs */
.mat-mdc-input-element {
  border: none !important;
  outline: none !important;
}

.mat-mdc-form-field-flex {
  align-items: baseline !important;
  padding: 0 !important;
}

/* ==========================================================================
   Outline Appearance Fixes
   ========================================================================== */

/* Outline appearance */
.mat-mdc-form-field-appearance-outline .mat-mdc-form-field-wrapper {
  padding: 0;
}

.mat-mdc-form-field-appearance-outline .mat-mdc-form-field-flex {
  padding: 0 1rem !important;
  margin-top: 0 !important;
  min-height: 48px !important;
  height: 48px !important;
}

.mat-mdc-form-field-appearance-outline .mat-mdc-text-field-wrapper {
  padding: 0;
  border: none !important;
}

.mat-mdc-form-field-appearance-outline .mat-mdc-notched-outline {
  top: 0;
}

/* Fix notched outline border rendering */
.mat-mdc-form-field-appearance-outline .mdc-notched-outline {
  display: flex;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
}

.mat-mdc-form-field-appearance-outline .mdc-notched-outline__leading {
  border-radius: 4px 0 0 4px;
  border: 1px solid;
  border-right: none;
}

.mat-mdc-form-field-appearance-outline .mdc-notched-outline__trailing {
  border-radius: 0 4px 4px 0;
  border: 1px solid;
  border-left: none;
  flex-grow: 1;
}

.mat-mdc-form-field-appearance-outline .mdc-notched-outline__notch {
  flex: 0 0 auto;
  border-left: none;
  border-right: none;
  max-width: calc(100% - 12px);
}

/* Hide the default border */
.mat-mdc-form-field-appearance-outline .mdc-notched-outline__notch {
  border-top: 1px solid;
  border-bottom: 1px solid;
}

/* When floating */
.mat-mdc-form-field-appearance-outline
  .mat-mdc-floating-label.mdc-floating-label--float-above
  ~ .mdc-notched-outline
  .mdc-notched-outline__notch {
  border-top: none;
}

.mat-mdc-form-field-appearance-outline .mat-mdc-form-field-infix {
  padding: 0.75rem 0 !important;
  border: none !important;
}

.mat-mdc-form-field-appearance-outline .mat-mdc-floating-label {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  transition: all 200ms cubic-bezier(0, 0, 0.2, 1);
  pointer-events: none;
}

.mat-mdc-form-field-appearance-outline.mat-focused .mat-mdc-floating-label,
.mat-mdc-form-field-appearance-outline.mat-form-field-should-float
  .mat-mdc-floating-label {
  transform: translateY(-1.75rem) scale(0.75);
  background-color: white;
  padding: 0 0.25rem;
}

/* ==========================================================================
   Fill Appearance
   ========================================================================== */

/* Fill appearance */
.mat-mdc-form-field-appearance-fill .mat-mdc-form-field-wrapper {
  padding-bottom: 0;
}

.mat-mdc-form-field-appearance-fill .mat-mdc-form-field-flex {
  position: relative;
  background-color: rgba(0, 0, 0, 0.04);
  border-radius: 4px 4px 0 0;
  padding: 0.75rem 0.75rem 0 0.75rem !important;
  min-height: 56px;
}

.mat-mdc-form-field-appearance-fill .mat-mdc-form-field-infix {
  padding: 0.75rem 0 0.5rem 0;
  border: none;
}

.mat-mdc-form-field-appearance-fill .mat-mdc-floating-label {
  position: absolute;
  left: 0.75rem;
  transition: all 200ms cubic-bezier(0, 0, 0.2, 1);
}

.mat-mdc-form-field-appearance-fill.mat-focused .mat-mdc-floating-label,
.mat-mdc-form-field-appearance-fill.mat-form-field-should-float
  .mat-mdc-floating-label {
  transform: translateY(-0.5rem) scale(0.75);
  transform-origin: left center;
}

.mat-mdc-form-field-appearance-fill .mat-mdc-form-field-underline {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 1px;
  background-color: rgba(0, 0, 0, 0.42);
}

.mat-mdc-form-field-appearance-fill .mat-mdc-form-field-ripple {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background-color: #3f51b5;
  transform: scaleX(0);
  transition: transform 180ms cubic-bezier(0.4, 0, 0.2, 1);
}

.mat-mdc-form-field-appearance-fill.mat-focused .mat-mdc-form-field-ripple {
  transform: scaleX(1);
}

/* ==========================================================================
   Input Element Styles
   ========================================================================== */

/* Input element styles */
.mat-mdc-input-element {
  font-size: 1rem;
  line-height: 1.5;
  color: rgba(0, 0, 0, 0.87);
  background: transparent;
  border: none;
  outline: none;
  padding: 0;
  margin: 0;
  width: 100%;
  max-width: 100%;
  vertical-align: bottom;
  text-align: inherit;
  caret-color: #3f51b5;
}

/* ==========================================================================
   Labels and States
   ========================================================================== */

/* Label and placeholder */
.mat-mdc-form-field-label {
  color: rgba(0, 0, 0, 0.6);
  font-size: 1rem;
  font-weight: 400;
  letter-spacing: 0.009375em;
}

.mat-mdc-form-field.mat-focused .mat-mdc-form-field-label {
  color: #3f51b5;
}

/* Error state */
.mat-mdc-form-field-invalid .mat-mdc-form-field-label {
  color: #f44336;
}

/* Fix form field subscript positioning */
.mat-mdc-form-field-subscript-wrapper {
  position: relative;
  margin-top: 0.25rem;
  font-size: 0.75rem;
  line-height: 1.2;
}

.mat-mdc-form-field-error {
  font-size: 0.75rem;
  line-height: 1.2;
  margin-top: 0.25rem;
  color: #f44336;
}

/* Hint */
.mat-mdc-form-field-hint {
  font-size: 0.75rem;
  line-height: 1.2;
  margin-top: 0.25rem;
  color: rgba(0, 0, 0, 0.6);
}

/* ==========================================================================
   Specific Component Fixes
   ========================================================================== */

/* Textarea specific */
textarea.mat-mdc-input-element {
  resize: vertical;
  overflow: auto;
  min-height: 75px;
}

/* Select specific */
.mat-mdc-select {
  display: inline-flex;
  width: 100%;
  outline: none;
}

.mat-mdc-select-trigger {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  position: relative;
  box-sizing: border-box;
  width: 100%;
}

.mat-mdc-select-value {
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.mat-mdc-select-arrow-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  width: 24px;
  height: 24px;
}

/* Datepicker specific - Lower specificity so form utilities can override */
.mat-mdc-form-field-icon-suffix,
.mat-mdc-form-field-icon-prefix {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

/* Only apply default margins when NOT inside form utility classes */
:not(.form-xs):not(.form-compact):not(.form-standard):not(.form-lg)
  .mat-mdc-form-field-icon-suffix {
  margin-left: 0.5rem;
}

:not(.form-xs):not(.form-compact):not(.form-standard):not(.form-lg)
  .mat-mdc-form-field-icon-prefix {
  margin-right: 0.5rem;
}

/* Fix floating label position when prefix icon is present in form utility classes */
/* Override Angular Material's label positioning with higher specificity and correct positioning */

/* Use margin-left instead of transform to ensure proper icon spacing */
.form-xs
  .mat-form-field-appearance-outline.mat-mdc-form-field-has-icon-prefix
  .mat-mdc-floating-label:not(.mdc-floating-label--float-above) {
  left: 30px !important; /* Move right by 16px icon + 6px margin + 8px buffer = 30px */
}

.form-compact
  .mat-form-field-appearance-outline.mat-mdc-form-field-has-icon-prefix
  .mat-mdc-floating-label:not(.mdc-floating-label--float-above) {
  left: 32px !important; /* Move right by 18px icon + 8px margin + 6px buffer = 32px */
}

.form-standard
  .mat-form-field-appearance-outline.mat-mdc-form-field-has-icon-prefix
  .mat-mdc-floating-label:not(.mdc-floating-label--float-above) {
  left: 36px !important; /* Move right by 20px icon + 10px margin + 6px buffer = 36px */
}

.form-lg
  .mat-form-field-appearance-outline.mat-mdc-form-field-has-icon-prefix
  .mat-mdc-floating-label:not(.mdc-floating-label--float-above) {
  left: 42px !important; /* Move right by 24px icon + 12px margin + 6px buffer = 42px */
}

/* ==========================================================================
   Border Colors and Focus States
   ========================================================================== */

/* Ensure proper outline colors for Material form fields */
.mat-mdc-form-field-appearance-outline:not(.mat-form-field-invalid)
  .mdc-notched-outline
  .mdc-notched-outline__leading,
.mat-mdc-form-field-appearance-outline:not(.mat-form-field-invalid)
  .mdc-notched-outline
  .mdc-notched-outline__notch,
.mat-mdc-form-field-appearance-outline:not(.mat-form-field-invalid)
  .mdc-notched-outline
  .mdc-notched-outline__trailing {
  border-color: rgba(0, 0, 0, 0.38) !important;
}

.mat-mdc-form-field-appearance-outline.mat-focused:not(.mat-form-field-invalid)
  .mdc-notched-outline
  .mdc-notched-outline__leading,
.mat-mdc-form-field-appearance-outline.mat-focused:not(.mat-form-field-invalid)
  .mdc-notched-outline
  .mdc-notched-outline__notch,
.mat-mdc-form-field-appearance-outline.mat-focused:not(.mat-form-field-invalid)
  .mdc-notched-outline
  .mdc-notched-outline__trailing {
  border-color: #3f51b5 !important;
  border-width: 2px !important;
}

/* Fix for form field with errors */
.mat-mdc-form-field-appearance-outline.mat-form-field-invalid
  .mdc-notched-outline
  .mdc-notched-outline__leading,
.mat-mdc-form-field-appearance-outline.mat-form-field-invalid
  .mdc-notched-outline
  .mdc-notched-outline__notch,
.mat-mdc-form-field-appearance-outline.mat-form-field-invalid
  .mdc-notched-outline
  .mdc-notched-outline__trailing {
  border-color: #f44336 !important;
}

/* Remove default Material backgrounds */
.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mat-mdc-form-field-infix {
  background-color: transparent;
}

.mat-mdc-text-field-wrapper.mdc-text-field--filled {
  background-color: transparent;
}

/* Ensure proper stacking */
.mat-mdc-form-field-wrapper {
  position: relative;
}

/* ==========================================================================
   Dense Form Fields
   ========================================================================== */

/* Fix for dense form fields */
.mat-mdc-form-field-appearance-outline.mat-mdc-form-field-dense
  .mat-mdc-form-field-flex {
  min-height: 48px;
}

.mat-mdc-form-field-appearance-fill.mat-mdc-form-field-dense
  .mat-mdc-form-field-flex {
  min-height: 48px;
}

/* ==========================================================================
   Fix Material outline input border issue with Tailwind
   ========================================================================== */

/* The issue is Tailwind sets border-style: solid globally, causing the notch to show borders */
.mdc-notched-outline__notch {
  border-right: none !important;
  border-left: none !important;
}

/* ==========================================================================
   Table Styles
   ========================================================================== */

/* Table */
table {
  width: 100%;
}

.mat-mdc-header-row {
  background-color: rgba(0, 0, 0, 0.04);
}

:host-context(.dark) .mat-mdc-header-row {
  background-color: rgba(255, 255, 255, 0.04);
}

.mat-column-select {
  overflow: initial;
}
